var Ze=Object.defineProperty;var et=(e,t,n)=>t in e?Ze(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var O=(e,t,n)=>(et(e,typeof t!="symbol"?t+"":t,n),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();class L{constructor(){this.options={},this.cachedSingletons=new Map,this.remove=t=>this.cachedSingletons.delete(t)}async dispose(){const n=Array.from(this.cachedSingletons.entries()).map(i=>i[1]).filter(i=>i!==this).map(async i=>{i.dispose&&await i.dispose()}),r=(await Promise.allSettled(n)).filter(i=>i.status==="rejected");if(r&&r.length)throw new Error(`There was an error during disposing '${r.length}' global disposable objects: ${r.map(i=>i.reason)}`);this.cachedSingletons.clear()}getInstance(t,n=[]){if(t===this.constructor)return this;if(this.cachedSingletons.has(t))return this.cachedSingletons.get(t);const s=L.options.get(t);if(!s)throw Error(`No metadata found for '${t.name}'. Dependencies: ${n.map(c=>c.name).join(",")}. Be sure that it's decorated with '@Injectable()' or added explicitly with SetInstance()`);if(n.includes(t))throw Error("Circular dependencies found.");const{lifetime:r}=s,i=Object.entries(L.injectableFields.get(t)||{});if(r==="singleton"){const c=[...i].map(([,d])=>({meta:L.options.get(d),dep:d})).filter(d=>d.meta&&(d.meta.lifetime==="scoped"||d.meta.lifetime==="transient")).map(d=>d.meta&&`${d.dep.name}:${d.meta.lifetime}`);if(c.length)throw Error(`Injector error: Singleton type '${t.name}' depends on non-singleton injectables: ${c.join(",")}`)}else if(r==="scoped"){const c=[...i.values()].map(([,d])=>({meta:L.options.get(d),dep:d})).filter(d=>d.meta&&d.meta.lifetime==="transient").map(d=>d.meta&&`${d.dep.name}:${d.meta.lifetime}`);if(c.length)throw Error(`Injector error: Scoped type '${t.name}' depends on transient injectables: ${c.join(",")}`)}const o=r==="singleton"&&this.options.parent&&this.options.parent.getInstance(t);if(o)return o;const a=i.map(([c,d])=>[c,this.getInstance(d,[...n,t])]),u=new t;return a.forEach(([c,d])=>{u[c]=d}),r!=="transient"&&this.setExplicitInstance(u),u}setExplicitInstance(t,n){const s=n||t.constructor;if(t.constructor===this.constructor)throw Error("Cannot set an injector instance as injectable");this.cachedSingletons.set(s,t)}createChild(t){const n=new L;return n.options=n.options||t,n.options.parent=this,n}}L.options=new Map;L.injectableFields=new Map;const tt={lifetime:"transient"},_=e=>t=>{L.options.set(t,{...tt,...e})};var P;(function(e){e[e.Verbose=0]="Verbose",e[e.Debug=1]="Debug",e[e.Information=2]="Information",e[e.Warning=3]="Warning",e[e.Error=4]="Error",e[e.Fatal=5]="Fatal"})(P||(P={}));const Ie="@furystack/core/AbstractLogger";class ve{constructor(){this.withScope=t=>({addEntry:n=>this.addEntry({scope:t,...n}),verbose:n=>this.verbose({scope:t,...n}),debug:n=>this.debug({scope:t,...n}),information:n=>this.information({scope:t,...n}),warning:n=>this.warning({scope:t,...n}),error:n=>this.error({scope:t,...n}),fatal:n=>this.fatal({scope:t,...n})})}async addEntryInternal(t){try{await this.addEntry(t)}catch(n){await this.error({scope:Ie,message:"There was an error adding entry to the log",data:{entry:t,error:n}})}}async verbose(t){await this.addEntryInternal({...t,level:P.Verbose})}async debug(t){await this.addEntryInternal({...t,level:P.Debug})}async information(t){await this.addEntryInternal({...t,level:P.Information})}async warning(t){await this.addEntryInternal({...t,level:P.Warning})}async error(t){try{await this.addEntry({...t,level:P.Error})}catch(n){await this.fatal({scope:Ie,message:"There was an error persisting an Error event in the log and therefore the event was elevated to Fatal level.",data:{originalEntry:t,error:n}})}}async fatal(t){await this.addEntry({...t,level:P.Fatal})}}var Ae=globalThis&&globalThis.__decorate||function(e,t,n,s){var r=arguments.length,i=r<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,n):s,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(r<3?o(i):r>3?o(t,n,i):o(t,n))||i);return r>3&&i&&Object.defineProperty(t,n,i),i};const ue="\x1B[0m",De="\x1B[31m",nt="\x1B[32m",it="\x1B[33m",rt="\x1B[34m",st="\x1B[36m",$e=e=>{switch(e){case P.Verbose:return st;case P.Debug:return rt;case P.Information:return nt;case P.Warning:return it;case P.Error:return De;default:return De}},ot=e=>[`${$e(e.level)}%s${ue}`,e.scope,e.message],at=e=>{const t=$e(e.level);return e.data?[`${t}%s${ue}`,e.scope,e.message,e.data]:[`${t}%s${ue}`,e.scope,e.message]};let ke=class extends ve{async addEntry(t){const n=ot(t);console.log(...n)}};ke=Ae([_({lifetime:"scoped"})],ke);let he=class extends ve{async addEntry(t){const n=at(t);console.log(...n)}};he=Ae([_({lifetime:"scoped"})],he);var lt=globalThis&&globalThis.__decorate||function(e,t,n,s){var r=arguments.length,i=r<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,n):s,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(r<3?o(i):r>3?o(t,n,i):o(t,n))||i);return r>3&&i&&Object.defineProperty(t,n,i),i};let Te=class extends ve{constructor(){super(...arguments),this.loggers=[]}async addEntry(t){const n=this.loggers.map(s=>s!==this?s.addEntry(t):Promise.resolve());await Promise.all(n)}attachLogger(...t){this.loggers.push(...t)}detach(t){this.loggers=this.loggers.filter(n=>n!==t)}};Te=lt([_({lifetime:"singleton"})],Te);const qe=(e,t=250)=>{let n;return(...s)=>{n&&clearTimeout(n),n=setTimeout(()=>{e(...s),n??clearTimeout(n),n=void 0},t)}};class ct{dispose(){this.observable.unsubscribe(this)}constructor(t,n){this.observable=t,this.callback=n}}class Z extends Error{constructor(){super("Observable already disposed")}}class v{get isDisposed(){return this._isDisposed}dispose(){this.observers.clear(),this._isDisposed=!0}subscribe(t,n=!1){if(this._isDisposed)throw new Z;const s=new ct(this,t);return this.observers.add(s),n&&t(this.currentValue),s}unsubscribe(t){return this.observers.delete(t)}getValue(){if(this._isDisposed)throw new Z;return this.currentValue}setValue(t){if(this._isDisposed)throw new Z;if(this.currentValue!==t){this.currentValue=t;for(const n of this.observers)n.callback(t)}}getObservers(){return[...this.observers]}constructor(t){this._isDisposed=!1,this.observers=new Set,t!==void 0&&(this.currentValue=t)}}class dt{static trimSlashes(t){for(;t.endsWith("/");)t=t.substring(0,t.length-1);for(;t.startsWith("/");)t=t.substring(1,t.length);return t}static getSegments(t){return t.split("/").filter(n=>n&&n.length)}static joinPaths(...t){return t.map(this.trimSlashes).join("/")}static isAncestorOf(t,n){return n.indexOf(`${this.joinPaths(t)}/`)===0}static getParentPath(t){const n=this.getSegments(t);return n.length>1&&n.pop(),n.join("/")}static normalize(t){return this.getSegments(t).join("/")}}const ut=(e,t,n,s)=>{const r=s==="asc"?e:t,i=s==="asc"?t:e;return r[n]<i[n]?-1:r[n]>i[n]?1:0};Array.prototype.sortBy=function(e,t="asc"){return this.sort((n,s)=>ut(n,s,e,t))};class te{static getMethodTrace(t,n){return this.objectTraces.get(t).methodMappings.get(n.name)}static traceStart(t,n){const r={methodArguments:n,startDateTime:new Date};return t.callObservable.setValue(r),r}static traceFinished(t,n,s,r){const i={methodArguments:n,startDateTime:s.startDateTime,finishedDateTime:new Date,returned:r};t.finishedObservable.setValue(i)}static traceError(t,n,s,r){const i={methodArguments:n,startDateTime:s.startDateTime,errorDateTime:new Date,error:r};return t.errorObservable.setValue(i),i}static callMethod(t,n,s){const r=this.getMethodTrace(t,n),i=this.traceStart(r,s);try{const o=r.originalMethod.call(t,...s);return this.traceFinished(r,s,i,o),o}catch(o){throw this.traceError(r,s,i,o),o}}static async callMethodAsync(t,n,s){const r=this.getMethodTrace(t,n),i=this.traceStart(r,s);try{const o=await r.originalMethod.call(t,...s);return this.traceFinished(r,s,i,o),o}catch(o){throw this.traceError(r,s,i,o),o}}static method(t){if(this.objectTraces.has(t.object)||this.objectTraces.set(t.object,{methodMappings:new Map}),!t.method.isTraced){const i=t.isAsync?(...o)=>this.callMethodAsync(t.object,t.method,o):(...o)=>this.callMethod(t.object,t.method,o);Object.defineProperty(i,"name",{value:t.method.name}),Object.defineProperty(i,"isTraced",{value:t.method.name}),t.object[t.method.name]=i}const n=this.objectTraces.get(t.object);n.methodMappings.has(t.method.name)||n.methodMappings.set(t.method.name,{originalMethod:t.method,callObservable:new v,finishedObservable:new v,errorObservable:new v});const s=n.methodMappings.get(t.method.name),r=[t.onCalled&&s.callObservable.subscribe(t.onCalled),t.onFinished&&s.finishedObservable.subscribe(t.onFinished),t.onError&&s.errorObservable.subscribe(t.onError)];return{dispose:()=>r.forEach(i=>i&&i.dispose())}}}te.objectTraces=new Map;const ht=e=>JSON.parse(decodeURIComponent(escape(atob(decodeURIComponent(e))))),oe=e=>{const t=[...new URLSearchParams(e).entries()].filter(([n,s])=>n&&s).map(([n,s])=>[n,ht(s)]);return Object.fromEntries(t)},ft=e=>encodeURIComponent(btoa(unescape(encodeURIComponent(JSON.stringify(e))))),gt=e=>new URLSearchParams(Object.fromEntries(Object.entries(e).filter(([,t])=>t!==void 0).map(([t,n])=>[t,ft(n)]))).toString();var mt=globalThis&&globalThis.__decorate||function(e,t,n,s){var r=arguments.length,i=r<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,n):s,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(r<3?o(i):r>3?o(t,n,i):o(t,n))||i);return r>3&&i&&Object.defineProperty(t,n,i),i},pt=globalThis&&globalThis.__metadata||function(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)};let q=class{dispose(){window.removeEventListener("popstate",this.updateState),window.removeEventListener("hashchange",this.updateState),this.pushStateTracer.dispose(),this.replaceStateTracer.dispose(),this.onLocationPathChanged.dispose(),this.onLocationSearchChanged.dispose(),this.onDeserializedLocationSearchChanged.dispose(),this.locationDeserializerObserver.dispose()}updateState(){this.onLocationPathChanged.setValue(location.pathname),this.onLocationHashChanged.setValue(location.hash),this.onLocationSearchChanged.setValue(location.search)}useSearchParam(t,n){const s=this.searchParamObservables.get(t);if(!s){const r=this.onDeserializedLocationSearchChanged.getValue()[t]??n,i=new v(r);return this.searchParamObservables.set(t,i),i.subscribe(o=>{const a=gt({...oe(location.search),[t]:o}),u=`${location.pathname}?${a}`;history.pushState({},"",u)}),this.onDeserializedLocationSearchChanged.subscribe(o=>{var u;const a=o[t]??n;(u=this.searchParamObservables.get(t))==null||u.setValue(a)}),i}return s}constructor(){this.onLocationPathChanged=new v(new URL(location.href).pathname),this.onLocationHashChanged=new v(location.hash),this.onLocationSearchChanged=new v(location.search),this.onDeserializedLocationSearchChanged=new v(oe(this.onLocationSearchChanged.getValue())),this.locationDeserializerObserver=this.onLocationSearchChanged.subscribe(t=>{this.onDeserializedLocationSearchChanged.setValue(oe(t))}),this.searchParamObservables=new Map,window.addEventListener("popstate",()=>this.updateState()),window.addEventListener("hashchange",()=>this.updateState()),this.pushStateTracer=te.method({object:history,method:history.pushState,isAsync:!1,onFinished:()=>this.updateState()}),this.replaceStateTracer=te.method({object:history,method:history.replaceState,isAsync:!1,onFinished:()=>this.updateState()})}};q=mt([_({lifetime:"singleton"}),pt("design:paramtypes",[])],q);var yt=globalThis&&globalThis.__decorate||function(e,t,n,s){var r=arguments.length,i=r<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,n):s,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(r<3?o(i):r>3?o(t,n,i):o(t,n))||i);return r>3&&i&&Object.defineProperty(t,n,i),i},vt=globalThis&&globalThis.__metadata||function(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)};const bt=["xs","sm","md","lg","xl"];let fe=class{dispose(){window.removeEventListener("resize",this.onResizeListener)}screenSizeAtLeast(t){return window.innerWidth>=this.breakpoints[t].minSize}refreshValues(){this.orientation.setValue(this.getOrientation()),bt.forEach(t=>{this.screenSize.atLeast[t].setValue(this.screenSizeAtLeast(t))})}constructor(){this.getOrientation=()=>{var t;return(t=window.matchMedia)!=null&&t.call(window,"(orientation:landscape").matches?"landscape":"portrait"},this.breakpoints={xl:{minSize:1920},lg:{minSize:1280},md:{minSize:960},sm:{minSize:600},xs:{minSize:0}},this.screenSize={atLeast:{xs:new v(this.screenSizeAtLeast("xs")),sm:new v(this.screenSizeAtLeast("sm")),md:new v(this.screenSizeAtLeast("md")),lg:new v(this.screenSizeAtLeast("lg")),xl:new v(this.screenSizeAtLeast("xl"))}},this.orientation=new v(this.getOrientation()),this.onResizeListener=()=>{this.refreshValues()},window.addEventListener("resize",this.onResizeListener),this.refreshValues()}};fe=yt([_({lifetime:"singleton"}),vt("design:paramtypes",[])],fe);const wt=e=>typeof e=="function",be=(e,t)=>{for(const n of t)typeof n=="string"||typeof n=="number"?e.appendChild(document.createTextNode(n)):n instanceof HTMLElement||n instanceof DocumentFragment?e.appendChild(n):n instanceof Array&&be(e,n)},xt=e=>(e==null?void 0:e.style)!==void 0,A=(e,t)=>{if(xt(t))for(const n in t.style)Object.prototype.hasOwnProperty.call(t.style,n)&&(e.style[n]=t.style[n])},St=(e,t)=>{t&&Object.entries(t).filter(([n])=>n.startsWith("data-")).forEach(([n,s])=>e.setAttribute(n,s||""))},R=(e,t)=>{Object.assign(e,t),t&&t.style&&A(e,t),St(e,t)},Ct=(...[e,t,...n])=>{if(typeof e=="string"){const s=document.createElement(e);return R(s,t),n&&be(s,n),s}else if(wt(e)){const s=e(t,n);return A(s,t),s}},Ot=(...[e,...t])=>{const n=document.createDocumentFragment();return be(n,t),n},l=(...e)=>e[0]===null?Ot(...e):Ct(...e);class Et{constructor(){this.disposables=new Map,this.observers=new Map,this.useObservable=(t,n,s,r)=>{const i=this.observers.get(t);if(i)return[i.observable.getValue(),i.observable.setValue.bind(i.observable)];const o=n.subscribe(s,r);return this.observers.set(t,o),[n.getValue(),n.setValue.bind(n)]},this.stateObservers=new Map,this.useState=(t,n,s)=>{if(!this.stateObservers.has(t)){const i=new v(n);this.stateObservers.set(t,i),i.subscribe(s)}const r=this.stateObservers.get(t);return[r.getValue(),r.setValue.bind(r)]}}useDisposable(t,n){return this.disposables.has(t)||this.disposables.set(t,n()),this.disposables.get(t)}dispose(){this.disposables.forEach(t=>t.dispose()),this.disposables.clear(),this.observers.forEach(t=>t.dispose()),this.observers.clear(),this.stateObservers.forEach(t=>t.dispose()),this.stateObservers.clear()}}const y=e=>{const t=e.shadowDomName;if(customElements.get(t))throw Error(`A custom shade with shadow DOM name '${e.shadowDomName}' has already been registered!`);{const s=e.elementBase||HTMLElement;customElements.define(t,class extends s{constructor(){super(...arguments),this._renderCount=0,this.resourceManager=new Et,this.render=r=>(this._renderCount++,e.render(r)),this.getRenderOptions=()=>({props:this.props,injector:this.injector,children:this.shadeChildren,element:this,renderCount:this._renderCount,useObservable:(i,o,a,u)=>this.resourceManager.useObservable(i,o,a||(()=>this.updateComponent()),u),useState:(i,o)=>this.resourceManager.useState(i,o,this.updateComponent.bind(this)),useSearchState:(i,o)=>this.resourceManager.useObservable(`useSearchState-${i}`,this.injector.getInstance(q).useSearchParam(i,o),()=>this.updateComponent()),useStoredState:(i,o,a=localStorage)=>{const u=()=>{const f=a==null?void 0:a.getItem(i);return f?JSON.parse(f):o},c=f=>{if(JSON.stringify(f)!==(a==null?void 0:a.getItem(i))){const g=JSON.stringify(f);a==null||a.setItem(i,g)}JSON.stringify(d.getValue())!==JSON.stringify(f)&&d.setValue(f)},d=this.resourceManager.useDisposable(`useStoredState-${i}`,()=>new v(u())),h=f=>{f.key===i&&f.storageArea===a&&c(f.newValue&&JSON.parse(f.newValue)||o)};return this.resourceManager.useDisposable(`useStoredState-${i}-storage-event`,()=>{window.addEventListener("storage",h);const f="useStoredState-broadcast-channel",g=new BroadcastChannel(f);g.onmessage=p=>{p.data.key===i&&c(p.data.value)};const m=d.subscribe(p=>{g.postMessage({key:i,value:p})});return{dispose:()=>{window.removeEventListener("storage",h),m.dispose(),g.close()}}}),d.subscribe(c),this.resourceManager.useObservable(`useStoredState-${i}`,d,()=>this.updateComponent())},useDisposable:this.resourceManager.useDisposable.bind(this.resourceManager)}),this.cleanup=void 0}getRenderCount(){return this._renderCount}connectedCallback(){var r;(r=e.onAttach)==null||r.call(e,this.getRenderOptions()),this.callConstructed()}disconnectedCallback(){var r,i;(r=e.onDetach)==null||r.call(e,this.getRenderOptions()),this.resourceManager.dispose(),(i=this.cleanup)==null||i.call(this)}updateComponent(){const r=this.render(this.getRenderOptions());r==null&&(this.innerHTML=""),(typeof r=="string"||typeof r=="number")&&(this.innerHTML=r),r instanceof HTMLElement&&this.replaceChildren(r),r instanceof DocumentFragment&&this.replaceChildren(r)}callConstructed(){this.updateComponent();const r=e.constructed&&e.constructed(this.getRenderOptions());r instanceof Promise?r.then(i=>this.cleanup=i):this.cleanup=r}getInjectorFromParent(){let r=this.parentElement;for(;r;){if(r.injector)return r.injector;r=r.parentElement}}get injector(){var o;if(this._injector)return this._injector;const r=(o=this.props)==null?void 0:o.injector;if(r&&r instanceof L)return r;const i=this.getInjectorFromParent();return i?(this._injector=i,i):new L}set injector(r){this._injector=r}},e.elementBaseName?{extends:e.elementBaseName}:void 0)}return(s,r)=>{const i=customElements.get(t),o=new i({...s});return o.props=s||{},o.shadeChildren=r,o}};y({shadowDomName:"lazy-load",constructed:async({props:e,useState:t,element:n})=>{const[s,r]=t("component",void 0),[i,o]=t("error",void 0);try{const a=await e.component();n.isConnected&&r(a)}catch(a){if(e.error)n.isConnected&&o(a);else throw a}},render:({props:e,useState:t})=>{const[n,s]=t("error",void 0),[r,i]=t("component",void 0);return n&&e.error?e.error(n,async()=>{try{s(void 0),i(void 0);const o=await e.component();i(o)}catch(o){s(o)}}):r||e.loader}});function It(e){for(var t=[],n=0;n<e.length;){var s=e[n];if(s==="*"||s==="+"||s==="?"){t.push({type:"MODIFIER",index:n,value:e[n++]});continue}if(s==="\\"){t.push({type:"ESCAPED_CHAR",index:n++,value:e[n++]});continue}if(s==="{"){t.push({type:"OPEN",index:n,value:e[n++]});continue}if(s==="}"){t.push({type:"CLOSE",index:n,value:e[n++]});continue}if(s===":"){for(var r="",i=n+1;i<e.length;){var o=e.charCodeAt(i);if(o>=48&&o<=57||o>=65&&o<=90||o>=97&&o<=122||o===95){r+=e[i++];continue}break}if(!r)throw new TypeError("Missing parameter name at ".concat(n));t.push({type:"NAME",index:n,value:r}),n=i;continue}if(s==="("){var a=1,u="",i=n+1;if(e[i]==="?")throw new TypeError('Pattern cannot start with "?" at '.concat(i));for(;i<e.length;){if(e[i]==="\\"){u+=e[i++]+e[i++];continue}if(e[i]===")"){if(a--,a===0){i++;break}}else if(e[i]==="("&&(a++,e[i+1]!=="?"))throw new TypeError("Capturing groups are not allowed at ".concat(i));u+=e[i++]}if(a)throw new TypeError("Unbalanced pattern at ".concat(n));if(!u)throw new TypeError("Missing pattern at ".concat(n));t.push({type:"PATTERN",index:n,value:u}),n=i;continue}t.push({type:"CHAR",index:n,value:e[n++]})}return t.push({type:"END",index:n,value:""}),t}function Dt(e,t){t===void 0&&(t={});for(var n=It(e),s=t.prefixes,r=s===void 0?"./":s,i="[^".concat(H(t.delimiter||"/#?"),"]+?"),o=[],a=0,u=0,c="",d=function(D){if(u<n.length&&n[u].type===D)return n[u++].value},h=function(D){var N=d(D);if(N!==void 0)return N;var z=n[u],re=z.type,se=z.index;throw new TypeError("Unexpected ".concat(re," at ").concat(se,", expected ").concat(D))},f=function(){for(var D="",N;N=d("CHAR")||d("ESCAPED_CHAR");)D+=N;return D};u<n.length;){var g=d("CHAR"),m=d("NAME"),p=d("PATTERN");if(m||p){var b=g||"";r.indexOf(b)===-1&&(c+=b,b=""),c&&(o.push(c),c=""),o.push({name:m||a++,prefix:b,suffix:"",pattern:p||i,modifier:d("MODIFIER")||""});continue}var x=g||d("ESCAPED_CHAR");if(x){c+=x;continue}c&&(o.push(c),c="");var C=d("OPEN");if(C){var b=f(),V=d("NAME")||"",S=d("PATTERN")||"",M=f();h("CLOSE"),o.push({name:V||(S?a++:""),pattern:V&&!S?i:S,prefix:b,suffix:M,modifier:d("MODIFIER")||""});continue}h("END")}return o}function He(e,t){var n=[],s=We(e,n,t);return kt(s,n,t)}function kt(e,t,n){n===void 0&&(n={});var s=n.decode,r=s===void 0?function(i){return i}:s;return function(i){var o=e.exec(i);if(!o)return!1;for(var a=o[0],u=o.index,c=Object.create(null),d=function(f){if(o[f]===void 0)return"continue";var g=t[f-1];g.modifier==="*"||g.modifier==="+"?c[g.name]=o[f].split(g.prefix+g.suffix).map(function(m){return r(m,g)}):c[g.name]=r(o[f],g)},h=1;h<o.length;h++)d(h);return{path:a,index:u,params:c}}}function H(e){return e.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function Be(e){return e&&e.sensitive?"":"i"}function Tt(e,t){if(!t)return e;for(var n=/\((?:\?<(.*?)>)?(?!\?)/g,s=0,r=n.exec(e.source);r;)t.push({name:r[1]||s++,prefix:"",suffix:"",modifier:"",pattern:""}),r=n.exec(e.source);return e}function _t(e,t,n){var s=e.map(function(r){return We(r,t,n).source});return new RegExp("(?:".concat(s.join("|"),")"),Be(n))}function Vt(e,t,n){return Nt(Dt(e,n),t,n)}function Nt(e,t,n){n===void 0&&(n={});for(var s=n.strict,r=s===void 0?!1:s,i=n.start,o=i===void 0?!0:i,a=n.end,u=a===void 0?!0:a,c=n.encode,d=c===void 0?function(se){return se}:c,h=n.delimiter,f=h===void 0?"/#?":h,g=n.endsWith,m=g===void 0?"":g,p="[".concat(H(m),"]|$"),b="[".concat(H(f),"]"),x=o?"^":"",C=0,V=e;C<V.length;C++){var S=V[C];if(typeof S=="string")x+=H(d(S));else{var M=H(d(S.prefix)),D=H(d(S.suffix));if(S.pattern)if(t&&t.push(S),M||D)if(S.modifier==="+"||S.modifier==="*"){var N=S.modifier==="*"?"?":"";x+="(?:".concat(M,"((?:").concat(S.pattern,")(?:").concat(D).concat(M,"(?:").concat(S.pattern,"))*)").concat(D,")").concat(N)}else x+="(?:".concat(M,"(").concat(S.pattern,")").concat(D,")").concat(S.modifier);else S.modifier==="+"||S.modifier==="*"?x+="((?:".concat(S.pattern,")").concat(S.modifier,")"):x+="(".concat(S.pattern,")").concat(S.modifier);else x+="(?:".concat(M).concat(D,")").concat(S.modifier)}}if(u)r||(x+="".concat(b,"?")),x+=n.endsWith?"(?=".concat(p,")"):"$";else{var z=e[e.length-1],re=typeof z=="string"?b.indexOf(z[z.length-1])>-1:z===void 0;r||(x+="(?:".concat(b,"(?=").concat(p,"))?")),re||(x+="(?=".concat(b,"|").concat(p,")"))}return new RegExp(x,Be(n))}function We(e,t,n){return e instanceof RegExp?Tt(e,t):Array.isArray(e)?_t(e,t,n):Vt(e,t,n)}var B=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ue={},we={};(function(e){var t=B&&B.__awaiter||function(r,i,o,a){return new(o||(o=Promise))(function(u,c){function d(g){try{f(a.next(g))}catch(m){c(m)}}function h(g){try{f(a.throw(g))}catch(m){c(m)}}function f(g){g.done?u(g.value):new o(function(m){m(g.value)}).then(d,h)}f((a=a.apply(r,i||[])).next())})},n=B&&B.__generator||function(r,i){var o={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},a,u,c;return{next:d(0),throw:d(1),return:d(2)};function d(f){return function(g){return h([f,g])}}function h(f){if(a)throw new TypeError("Generator is already executing.");for(;o;)try{if(a=1,u&&(c=u[f[0]&2?"return":f[0]?"throw":"next"])&&!(c=c.call(u,f[1])).done)return c;switch(u=0,c&&(f=[0,c.value]),f[0]){case 0:case 1:c=f;break;case 4:return o.label++,{value:f[1],done:!1};case 5:o.label++,u=f[1],f=[0];continue;case 7:f=o.ops.pop(),o.trys.pop();continue;default:if(c=o.trys,!(c=c.length>0&&c[c.length-1])&&(f[0]===6||f[0]===2)){o=0;continue}if(f[0]===3&&(!c||f[1]>c[0]&&f[1]<c[3])){o.label=f[1];break}if(f[0]===6&&o.label<c[1]){o.label=c[1],c=f;break}if(c&&o.label<c[2]){o.label=c[2],o.ops.push(f);break}c[2]&&o.ops.pop(),o.trys.pop();continue}f=i.call(r,o)}catch(g){f=[6,g],u=0}finally{a=c=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}};e.__esModule=!0;var s=function(){function r(i){this.promiseResolverQueue=[],this.permits=i}return r.prototype.getPermits=function(){return this.permits},r.prototype.wait=function(){return t(this,void 0,void 0,function(){var i=this;return n(this,function(o){return this.permits>0?(this.permits-=1,[2,Promise.resolve(!0)]):[2,new Promise(function(a){return i.promiseResolverQueue.push(a)})]})})},r.prototype.acquire=function(){return t(this,void 0,void 0,function(){return n(this,function(i){return[2,this.wait()]})})},r.prototype.waitFor=function(i){return t(this,void 0,void 0,function(){var o=this,a,u;return n(this,function(c){return this.permits>0?(this.permits-=1,[2,Promise.resolve(!0)]):(a=function(d){},u=new Promise(function(d){a=d}),this.promiseResolverQueue.push(a),setTimeout(function(){var d=o.promiseResolverQueue.indexOf(a);d!==-1&&o.promiseResolverQueue.splice(d,1),a(!1)},i),[2,u])})})},r.prototype.tryAcquire=function(){return this.permits>0?(this.permits-=1,!0):!1},r.prototype.drainPermits=function(){if(this.permits>0){var i=this.permits;return this.permits=0,i}return 0},r.prototype.signal=function(){if(this.permits+=1,this.permits>1&&this.promiseResolverQueue.length>0)throw new Error("this.permits should never be > 0 when there is someone waiting.");if(this.permits===1&&this.promiseResolverQueue.length>0){this.permits-=1;var i=this.promiseResolverQueue.shift();i&&i(!0)}},r.prototype.release=function(){this.signal()},r.prototype.execute=function(i){return t(this,void 0,void 0,function(){return n(this,function(o){switch(o.label){case 0:return[4,this.wait()];case 1:o.sent(),o.label=2;case 2:return o.trys.push([2,,4,5]),[4,i()];case 3:return[2,o.sent()];case 4:return this.signal(),[7];case 5:return[2]}})})},r}();e.default=s})(we);var xe={},Pt=B&&B.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var s in n)n.hasOwnProperty(s)&&(t[s]=n[s])};return function(t,n){e(t,n);function s(){this.constructor=t}t.prototype=n===null?Object.create(n):(s.prototype=n.prototype,new s)}}();xe.__esModule=!0;var Rt=we,Mt=function(e){Pt(t,e);function t(){return e.call(this,1)||this}return t}(Rt.default);xe.Lock=Mt;(function(e){function t(s){for(var r in s)e.hasOwnProperty(r)||(e[r]=s[r])}e.__esModule=!0;var n=we;e.default=n.default,t(xe)})(Ue);const Lt=y({shadowDomName:"shade-router",render:e=>{const{useState:t,useObservable:n,injector:s}=e,[r]=t("lock",new Ue.Lock),[i,o]=t("routerState",{jsx:l("div",null)}),a=async u=>{var g,m;const[c]=t("routerState",i),{activeRoute:d,activeRouteParams:h,jsx:f}=c;try{await r.acquire();for(const p of e.props.routes){const x=He(p.url,p.routingOptions)(u);if(x){if(p!==d||JSON.stringify(h)!==JSON.stringify(x.params)){await((g=d==null?void 0:d.onLeave)==null?void 0:g.call(d,{...e,element:c.jsx}));const C=p.component({currentUrl:u,match:x});o({jsx:C,activeRoute:p,activeRouteParams:x.params}),await((m=p.onVisit)==null?void 0:m.call(p,{...e,element:C}))}return}}d!=null&&d.onLeave&&await d.onLeave({...e,element:f}),o({jsx:e.props.notFound||l("div",null),activeRoute:null,activeRouteParams:null})}catch(p){if(!(p instanceof Z))throw p}finally{r==null||r.release()}};return n("locationPathChanged",s.getInstance(q).onLocationPathChanged,a,!0),i.jsx}}),J=y({shadowDomName:"route-link",elementBase:HTMLAnchorElement,elementBaseName:"a",render:({children:e,props:t,injector:n,element:s})=>(R(s,{...t,style:{color:"inherit",textDecoration:"inherit",...t.style},onclick:r=>{r.preventDefault(),history.pushState("",t.title||"",t.href),n.getInstance(q).updateState()}}),l(l,null,e))}),Ft=e=>{e.jsxElement.injector=e.injector,e.rootElement.appendChild(e.jsxElement)};var jt=Object.defineProperty,zt=Object.getOwnPropertyDescriptor,At=(e,t,n,s)=>{for(var r=s>1?void 0:s?zt(t,n):t,i=e.length-1,o;i>=0;i--)(o=e[i])&&(r=(s?o(t,n,r):o(r))||r);return s&&r&&jt(t,n,r),r};let ne=class{constructor(){O(this,"nodeEnv");O(this,"debug");O(this,"buildDate");O(this,"site")}};ne=At([_({lifetime:"singleton"})],ne);const w=async(e,t,n)=>new Promise((s,r)=>{if(!e)return r(new Error("No element provided"));const i=e.animate(t,n);i.onfinish=s,i.oncancel=r}),_e=(e,t)=>w(e,[{height:`${e==null?void 0:e.scrollHeight}px`,opacity:1},{height:"0px",opacity:0}],{duration:500,easing:"cubic-bezier(0.215, 0.610, 0.355, 1.000)",fill:"forwards",...t}),Ve=(e,t)=>w(e,[{height:"0px",opacity:0},{height:`${e==null?void 0:e.scrollHeight}px`,opacity:1}],{duration:500,easing:"cubic-bezier(0.215, 0.610, 0.355, 1.000)",fill:"forwards",...t}),Je={text:{primary:"var(--shades-theme-text-primary)",secondary:"var(--shades-theme-text-secondary)",disabled:"var(--shades-theme-text-disabled)"},button:{active:"var(--shades-theme-button-active)",hover:"var(--shades-theme-button-hover)",selected:"var(--shades-theme-button-selected)",disabled:"var(--shades-theme-button-disabled)",disabledBackground:"var(--shades-theme-button-disabled-background)"},background:{default:"var(--shades-theme-background-default)",paper:"var(--shades-theme-background-paper)"},palette:{primary:{light:"var(--shades-theme-palette-primary-light)",main:"var(--shades-theme-palette-primary-main)",dark:"var(--shades-theme-palette-primary-dark)"},secondary:{light:"var(--shades-theme-palette-secondary-light)",main:"var(--shades-theme-palette-secondary-main)",dark:"var(--shades-theme-palette-secondary-dark)"},error:{light:"var(--shades-theme-palette-error-light)",main:"var(--shades-theme-palette-error-main)",dark:"var(--shades-theme-palette-error-dark)"},warning:{light:"var(--shades-theme-palette-warning-light)",main:"var(--shades-theme-palette-warning-main)",dark:"var(--shades-theme-palette-warning-dark)"},info:{light:"var(--shades-theme-palette-info-light)",main:"var(--shades-theme-palette-info-main)",dark:"var(--shades-theme-palette-info-dark)"},success:{light:"var(--shades-theme-palette-success-light)",main:"var(--shades-theme-palette-success-main)",dark:"var(--shades-theme-palette-success-dark)"}},divider:"var(--shades-theme-divider)"},$t=(e,t,n)=>{n.style.setProperty(e.replace("var(","").replace(")",""),t)},qt=(e,t=document.querySelector(":root"))=>getComputedStyle(t).getPropertyValue(e.replace("var(","").replace(")","")),Ge=(e,t,n,s=$t)=>{Object.keys(e).forEach(i=>{if(typeof t[i]=="object"&&typeof e[i]=="object"){Ge(e[i],t[i],n);return}else s(e[i],t[i],n)})},Ht=e=>{const t=document.querySelector(":root");Ge(Je,e,t)};var Bt=globalThis&&globalThis.__decorate||function(e,t,n,s){var r=arguments.length,i=r<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,n):s,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(r<3?o(i):r>3?o(t,n,i):o(t,n))||i);return r>3&&i&&Object.defineProperty(t,n,i),i};class ae{constructor(t,n,s,r=1){this.r=t,this.g=n,this.b=s,this.a=r}update(t,n){return this[t]=n,this}toString(){return`rgba(${this.r},${this.g},${this.b},${this.a})`}}let E=class{constructor(){this.theme=Je}getTextColor(t,n="#000000",s="#FFFFFF"){const{r,g:i,b:o}=this.getRgbFromColorString(t);return(r*299+i*587+o*114)/1e3>=128?n:s}getRgbFromColorString(t){if(t.startsWith("var(--"))return this.getRgbFromColorString(qt(t));if(t.startsWith("#")){if(t.length===7){const n=parseInt(t.substr(1,2),16),s=parseInt(t.substr(3,2),16),r=parseInt(t.substr(5,2),16);return new ae(n,s,r)}if(t.length===4){const n=parseInt(t.substr(1,1)+t.substr(1,1),16),s=parseInt(t.substr(2,1)+t.substr(2,1),16),r=parseInt(t.substr(3,1)+t.substr(3,1),16);return new ae(n,s,r)}}if(t.startsWith("rgba(")){const n=new RegExp(/^rgba[(](?<red>[\d]+)[,][\s]?(?<green>[\d]+)[,][\s]?(?<blue>[\d]+)[,][\s]?(?<alpha>[\d|.]+)[)]/gm).exec(t);if(n&&n.groups)return new ae(parseInt(n.groups.red,10),parseInt(n.groups.green,10),parseInt(n.groups.blue,10),parseInt(n.groups.alpha,10))}throw Error(`Color format '${t}' is not supported.'`)}set(t){Ht(t)}dispose(){}};E=Bt([_({lifetime:"singleton"})],E);const Wt=y({shadowDomName:"shade-app-bar",constructed:({element:e})=>{requestAnimationFrame(()=>{e.style.opacity="1"})},render:({children:e,injector:t,element:n})=>{const{theme:s}=t.getInstance(E);return R(n,{style:{width:"100%",background:"rgba(128,128,128,0.2)",backdropFilter:"blur(15px)",display:"flex",justifyContent:"flex-start",alignItems:"center",boxShadow:"0 0 12px rgba(0,0,0,0.6)",transition:"opacity .35s cubic-bezier(0.550, 0.085, 0.680, 0.530), padding .2s cubic-bezier(0.550, 0.085, 0.680, 0.530)",opacity:"0",position:"fixed",zIndex:"1",color:s.text.secondary}}),l(l,null,e)}});y({shadowDomName:"shade-app-bar-link",render:({children:e,props:t,useObservable:n,injector:s,element:r})=>{const i=a=>{const u=!!He(t.href)(a),c=s.getInstance(E),{theme:d}=c;return{display:"flex",height:"100%",textDecoration:"none",alignItems:"center",padding:"0 8px",transition:"color .2s ease-in-out, transform .2s ease-in-out",color:u?d.text.primary:d.text.secondary,opacity:u?"1":"0.8",transform:u?"scale(1)":"scale(0.9)",cursor:"pointer"}},[o]=n("locationChange",s.getInstance(q).onLocationPathChanged);return R(r,{style:i(o)}),l(J,{...t},e)}});var Ut=globalThis&&globalThis.__decorate||function(e,t,n,s){var r=arguments.length,i=r<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,n):s,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(r<3?o(i):r>3?o(t,n,i):o(t,n))||i);return r>3&&i&&Object.defineProperty(t,n,i),i};let $=class{constructor(){this.validatedFormData=new v(null),this.rawFormData=new v(null),this.validationResult=new v({isValid:null}),this.fieldErrors=new v({}),this.inputs=new Set,this.setFieldState=(t,n,s)=>{this.fieldErrors.setValue({...this.fieldErrors.getValue(),[t]:{validationResult:n,validity:s}})}}dispose(){this.validatedFormData.dispose(),this.rawFormData.dispose(),this.validationResult.dispose()}};$=Ut([_({lifetime:"scoped"})],$);const Jt=y({shadowDomName:"shade-form",elementBase:HTMLFormElement,elementBaseName:"form",render:({props:e,children:t,useDisposable:n,element:s,injector:r})=>{const i=n("formInjector",()=>r.createChild({owner:s}));s.injector=i;const o=new $;i.setExplicitInstance(o);const a=(u,c)=>{o.inputs.forEach(f=>{const g=document.createEvent("FocusEvent");g.initEvent("blur",!0,!0),f.dispatchEvent(g)});const d=Object.fromEntries(new FormData(u.currentTarget).entries());o.rawFormData.setValue(d);const h=o.fieldErrors.getValue();Object.values(h).some(f=>(f==null?void 0:f.validationResult.isValid)===!1)||[...o.inputs].some(f=>!f.validity.valid)?o.validationResult.setValue({isValid:!1,reason:"input-validation-failed"}):e.validate(d)?(o.validationResult.setValue({isValid:!0}),o.validatedFormData.setValue(d),c&&e.onSubmit(d)):o.validationResult.setValue({isValid:!1,reason:"validation-failed"})};return R(s,{injector:i,...e,oninvalid:u=>{a(u)},onsubmit:u=>{u.preventDefault(),a(u,!0)},onchange:u=>{a(u)},onreset:()=>{o.rawFormData.setValue(null),o.validationResult.setValue({isValid:null}),o.validatedFormData.setValue(null)}}),l(l,null,t)}}),Ne=({themeProvider:e,props:t,state:n,validationResult:s})=>{var r,i,o,a;return{display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"space-between",fontSize:"10px",color:t.disabled?e.theme.text.disabled:((r=n.validity)==null?void 0:r.valid)===!1||(s==null?void 0:s.isValid)===!1?e.theme.palette.error.main:n.focused?e.theme.text.primary:e.theme.text.secondary,marginBottom:"1em",padding:"1em",borderRadius:"5px",background:t.variant==="contained"?e.getRgbFromColorString(((i=n.validity)==null?void 0:i.valid)===!1||(s==null?void 0:s.isValid)===!1?e.theme.palette.error.main:e.theme.palette[t.defaultColor||"primary"].main).update("a",n.focused?.1:.2).toString():"transparent",boxShadow:t.variant==="outlined"||t.variant==="contained"?`0 0 0 1px ${((o=n.validity)==null?void 0:o.valid)===!1||(s==null?void 0:s.isValid)===!1?e.theme.palette.error.main:n.focused?e.theme.palette[t.defaultColor||"primary"].main:e.theme.text.primary}`:"none",filter:t.disabled?"grayscale(100%)":"none",opacity:t.disabled?"0.5":"1",transition:"color 0.2s ease-in-out, filter 0.2s ease-in-out, opacity 0.2s ease-in-out, border-color 0.2s ease-in-out, box-shadow 0.2s ease-in-out",...(a=t.labelProps)==null?void 0:a.style}},Gt=e=>{if(!e.valid){if(e.valueMissing)return"Value is required";if(e.typeMismatch)return"Value is not valid";if(e.patternMismatch)return"Value does not match the pattern";if(e.tooLong)return"Value is too long";if(e.tooShort)return"Value is too short";if(e.rangeUnderflow)return"Value is too low";if(e.rangeOverflow)return"Value is too high";if(e.stepMismatch)return"Value is not a valid step";if(e.badInput)return"Value is not valid"}},Se=y({shadowDomName:"shade-input",constructed:({injector:e,element:t})=>{if(e.cachedSingletons.has($)){const n=t.querySelector("input"),s=e.getInstance($);return s.inputs.add(n),()=>s.inputs.delete(n)}},render:({props:e,injector:t,useObservable:n,element:s})=>{var u,c,d;const r=t.getInstance(E),i=h=>{var V,S,M,D,N;const f=s.querySelector("label"),g=s.querySelector("input");h.value=(g==null?void 0:g.value)||h.value,h.validity=(g==null?void 0:g.validity)||h.validity,h.validity.toJSON=()=>({valid:h.validity.valid,valueMissing:h.validity.valueMissing,typeMismatch:h.validity.typeMismatch,patternMismatch:h.validity.patternMismatch,tooLong:h.validity.tooLong,tooShort:h.validity.tooShort,rangeUnderflow:h.validity.rangeUnderflow,rangeOverflow:h.validity.rangeOverflow,stepMismatch:h.validity.stepMismatch,badInput:h.validity.badInput});const m=(V=e.getValidationResult)==null?void 0:V.call(e,{state:h});(m==null?void 0:m.isValid)===!1||((S=h.validity)==null?void 0:S.valid)===!1?s.setAttribute("data-validation-failed","true"):s.removeAttribute("data-validation-failed"),A(f,{style:Ne({themeProvider:r,props:e,state:h,validationResult:m})});const p=s.querySelector("span.helperText"),b=(m==null?void 0:m.isValid)===!1&&(m==null?void 0:m.message)||((M=e.getHelperText)==null?void 0:M.call(e,{state:h,validationResult:m}))||Gt(h.validity)||"";p==null||p.replaceChildren(b);const x=s.querySelector("span.startIcon");x==null||x.replaceChildren(((D=e.getStartIcon)==null?void 0:D.call(e,{state:h,validationResult:m}))||"");const C=s.querySelector("span.endIcon");return C==null||C.replaceChildren(((N=e.getEndIcon)==null?void 0:N.call(e,{state:h,validationResult:m}))||""),t.cachedSingletons.has($)&&t.getInstance($).setFieldState(e.name,m||{isValid:!0},h.validity),h},[o,a]=n("inputState",new v({value:e.value||"",focused:e.autofocus||!1,validity:((u=s.querySelector("input"))==null?void 0:u.validity)||{},element:s}),i);return l("label",{...e.labelProps,style:Ne({props:e,state:o,themeProvider:r})},e.labelTitle,l("div",{style:{display:"flex",alignItems:"center",width:"100%"}},e.getStartIcon?l("span",{className:"startIcon"},(c=e.getStartIcon)==null?void 0:c.call(e,{state:o})):null,l("input",{oninvalid:h=>{h.preventDefault();const f=h.target;a({...o,validity:f.validity})},onchange:h=>{var m;const f=h.target,g=f.value;a({...o,value:g,validity:f==null?void 0:f.validity}),(m=e.onTextChange)==null||m.call(e,g),e.onchange&&e.onchange(h)},onfocus:h=>{const f=h.target;a({...o,focused:!0,validity:f.validity})},onblur:h=>{const f=h.target;a({...o,focused:!1,validity:f.validity})},...e,style:{color:"inherit",border:"none",backgroundColor:"transparent",outline:"none",fontSize:"12px",width:"100%",textOverflow:"ellipsis",padding:"0",marginTop:"0.6em",marginBottom:"0.4em",flexGrow:"1",...e.style},value:o.value}),e.getEndIcon?l("span",{className:"endIcon"},e.getEndIcon({state:o})):null),l("span",{className:"helperText"},(d=e.getHelperText)==null?void 0:d.call(e,{state:o})))}});y({shadowDomName:"shade-autocomplete",render:({props:e,useState:t})=>{const[n]=t("dataListId",(Math.random()+1).toString(36).substring(3));return l("div",null,l(Se,{...e.inputProps,list:n,onchange:s=>{var i;const{value:r}=s.target;if(e.strict&&!e.suggestions.includes(r)){s.target.setCustomValidity("Please select a valid entry!");return}(i=e.onchange)==null||i.call(e,r)}}),l("datalist",{id:n},e.suggestions.map(s=>l("option",{value:s}))))}});y({shadowDomName:"shade-text-area",render:({props:e,element:t,injector:n})=>{var o;const s=n.getInstance(E),{theme:r}=s,{palette:i}=r;return l("label",{...e.labelProps,style:{display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"space-between",fontSize:"10px",color:e.disabled?"rgb(170, 170, 170)":"#bbb",marginBottom:"1em",padding:"1em",borderRadius:"5px",border:e.variant==="outlined"?"1px solid #bbb":"none",...(o=e.labelProps)==null?void 0:o.style}},l("span",null,e.labelTitle),l("div",{contentEditable:e.readOnly===!0||e.disabled===!0?"inherit":"true",...e,style:{border:"none",backgroundColor:"transparent",outline:"none",fontSize:"12px",width:"100%",textOverflow:"ellipsis",...e.style},onfocus:()=>{e.disabled||(w(t.querySelector("label"),[{color:s.getTextColor(r.background.default)},{color:i.primary.main}],{duration:500,easing:"cubic-bezier(0.455, 0.030, 0.515, 0.955)",fill:"forwards"}),w(t.querySelector('div[contenteditable="true"]'),[{boxShadow:"0px 0px 0px rgba(128,128,128,0.1)"},{boxShadow:`0px 3px 0px ${i.primary.main}`}],{duration:200,fill:"forwards"}))},onblur:()=>{e.disabled||(w(t.querySelector("label"),[{color:i.primary.main},{color:s.getTextColor(r.background.default)}],{duration:200,easing:"cubic-bezier(0.455, 0.030, 0.515, 0.955)",fill:"forwards"}),w(t.querySelector('div[contenteditable="true"]'),[{boxShadow:"0px 3px 0px rgba(128,128,128,0.4)"},{boxShadow:"0px 0px 0px rgba(128,128,128,0.1)"}],{duration:400,fill:"forwards"}))}},e.value))}});y({shadowDomName:"shade-avatar",render:({props:e,element:t})=>{const{avatarUrl:n,...s}=e;return R(t,{...s,style:{width:"128px",height:"128px",overflow:"hidden",borderRadius:"50%",boxShadow:"0px 0px 8px 3px rgba(128,128,128,0.2)",backgroundColor:"rgba(128,128,128,0.3)",display:"flex",...s==null?void 0:s.style}}),l("img",{style:{width:"100%",height:"100%",objectFit:"cover",backgroundPosition:"center"},alt:"avatar image",src:e.avatarUrl,onerror:r=>{r.target.replaceWith(l("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",width:"100%"}},l("div",{style:{textAlign:"center",userSelect:"none",fontSize:"32px"}},e.fallback||"ðŸ›‘")))}})}});const Qt=(e,t)=>e.variant==="contained"?e.color?e.disabled?t.palette[e.color].dark:t.palette[e.color].main:e.disabled?t.button.disabledBackground:t.text.primary:"rgba(0,0,0,0)",Xt=(e,t,n)=>e.variant==="contained"?e.color?t.palette[e.color].dark:e.disabled?t.button.disabledBackground:t.text.secondary:n(),Yt=(e,t)=>e.variant==="outlined"?e.color?`0px 0px 0px 1px ${e.disabled?t.palette[e.color].dark:t.palette[e.color].main}`:`0px 0px 0px 1px ${e.disabled?t.button.disabledBackground:t.text.secondary}`:"none",Kt=(e,t)=>e.variant==="outlined"?e.color?`0px 0px 0px 1px ${e.disabled?t.button.disabledBackground:t.palette[e.color].light}`:`0px 0px 0px 1px ${e.disabled?t.button.disabledBackground:t.text.primary}`:"none",Pe=(e,t,n)=>e.variant!=="contained"?e.color?e.disabled?t.palette[e.color].dark:t.palette[e.color].main:t.text.secondary:n(),Zt=(e,t,n)=>e.variant!=="contained"?e.color?e.disabled?t.palette[e.color].dark:t.palette[e.color].light:t.text.primary:n(),F=y({shadowDomName:"shade-button",elementBase:HTMLButtonElement,elementBaseName:"button",constructed:({element:e})=>{function t(n){n.target===e&&w(e,[{filter:"drop-shadow(1px 1px 10px rgba(0,0,0,.5))brightness(1)",transform:"scale(1)"}],{duration:350,fill:"forwards",easing:"cubic-bezier(0.230, 1.000, 0.320, 1.000)"})}return document.addEventListener("mouseup",t),()=>{document.removeEventListener("mouseup",t)}},render:({props:e,children:t,injector:n,element:s,useDisposable:r})=>{const i=e.onmousedown,o=e.onmouseup,a=n.getInstance(E),{theme:u}=a,c=Qt(e,u);e.variant==="contained"&&r("themeChanged",()=>te.method({object:a,method:a.set,onFinished:()=>{const b=s;b.style.color=Pe(e,a.theme,()=>a.getTextColor(b.style.background||b.style.backgroundColor))}}));const d=Xt(e,u,()=>{const{r:b,g:x,b:C}=a.getRgbFromColorString(e.color&&u.palette[e.color].main||u.text.primary);return`rgba(${b}, ${x}, ${C}, 0.1)`}),h=Yt(e,u),f=Kt(e,u),g=()=>Pe(e,u,()=>a.getTextColor(c)),m=()=>Zt(e,u,()=>a.getTextColor(c)),p=async(b,x)=>{const C=s;C&&w(C,b,x)};return R(s,{...e,onmousedown(b){i==null||i.call(this,b),p([{filter:"drop-shadow(-1px -1px 3px black)brightness(0.5)",transform:"scale(0.98)"}],{duration:150,fill:"forwards",easing:"cubic-bezier(0.230, 1.000, 0.320, 1.000)"})},onmouseup(b){o==null||o.call(this,b)},onmouseenter:()=>{p([{background:c,boxShadow:h,color:g()},{background:d,boxShadow:f,color:m()}],{duration:500,fill:"forwards",easing:"cubic-bezier(0.215, 0.610, 0.355, 1.000)"})},onmouseout:()=>{p([{background:d,boxShadow:f,color:m()},{background:c,boxShadow:h,color:g()}],{duration:500,fill:"forwards",easing:"cubic-bezier(0.215, 0.610, 0.355, 1.000)"})},...e,style:{display:"inline-flex",cursor:e.disabled?"not-allowed":"pointer",background:c,boxShadow:h,margin:"8px",padding:"6px 16px",border:"none",borderRadius:"4px",textTransform:"uppercase",color:g(),filter:"drop-shadow(1px 1px 10px rgba(0,0,0,.5))",backdropFilter:e.variant==="outlined"?"blur(35px)":void 0,userSelect:"none",...e.style}}),l(l,null,t)}}),en=y({shadowDomName:"data-grid-order-button",render:({props:e,useObservable:t})=>{const[n,s]=t("currentQuerySettings",e.collectionService.querySettings),r=Object.keys(n.order||{})[0],i=Object.values(n.order||{})[0];return l(F,{title:"Change order",style:{padding:"4px",margin:"0",cursor:"pointer"},color:r===e.field?"info":void 0,onclick:o=>{o.stopPropagation();let a="ASC";const u={};r===e.field&&(a=i==="ASC"?"DESC":"ASC"),u[e.field]=a,s({...n,order:u})}},r===e.field&&(i==="ASC"?"â¬‡":"â¬†")||"â†•")}}),tn=y({shadowDomName:"data-grid-search-button",render:({props:e,useObservable:t,element:n})=>{var i,o;const[s]=t("currentFilterState",e.service.querySettings,a=>{var d,h;const u=((h=(d=a.filter)==null?void 0:d[e.fieldName])==null?void 0:h.$regex)||"",c=n.querySelector("button");c.innerHTML=u?"ðŸ”":"ðŸ”Ž",c.style.textShadow=u?"1px 1px 20px rgba(235,225,45,0.9), 1px 1px 12px rgba(235,225,45,0.9), 0px 0px 3px  rgba(255,200,145,0.6)":"none"}),r=((o=(i=s.filter)==null?void 0:i[e.fieldName])==null?void 0:o.$regex)||"";return l(F,{type:"button",title:"Filter",style:{padding:"4px",margin:"0",cursor:"pointer"},onclick:e.onclick},r?"ðŸ”":"ðŸ”Ž")}}),nn=y({shadowDomName:"data-grid-search-form",render:({props:e,useObservable:t,element:n})=>{var r,i;const[s]=t("currentFilterState",e.service.querySettings,o=>{var u,c;const a=((c=(u=o.filter)==null?void 0:u[e.fieldName])==null?void 0:c.$regex)||"";n.querySelector("input").value=a});return l(Jt,{className:"search-form",style:{display:"flex",width:"100%",overflow:"hide",height:"0px",justifyContent:"space-around",opacity:"0"},validate:o=>{var a;return(a=o.searchValue)==null?void 0:a.length},onSubmit:({searchValue:o})=>{e.onSubmit(o)}},l(Se,{style:{padding:"0px",paddingBottom:"0",margin:"0"},placeholder:e.fieldName,autofocus:!0,labelTitle:`${e.fieldName}`,name:"searchValue",value:((i=(r=s.filter)==null?void 0:r[e.fieldName])==null?void 0:i.$regex)||"",labelProps:{style:{padding:"0px 2em"}}}),l("div",{style:{display:"flex",width:"64px",alignItems:"center",justifyContent:"center",gap:"8px"}},l(F,{type:"reset",style:{padding:"4px",margin:"0"},onclick:()=>{e.onClear()}},"âŒ"),l(F,{style:{padding:"4px",margin:"0"},type:"submit"},"ðŸ”Ž")))}}),rn=y({shadowDomName:"data-grid-header",render:({props:e,element:t,useObservable:n})=>{const[,s]=n("isSearchOpened",new v(!1),i=>{const o=t.querySelector(".search-form"),a=t.querySelector(".header-content");i?(o.style.display="flex",Ve(o).then(()=>{var u;return(u=o.querySelector("input"))==null?void 0:u.focus()}),_e(a)):(_e(o),Ve(a))}),r=i=>{const o=e.collectionService.querySettings.getValue();if(i){const a={...o,filter:{...o.filter,[e.field]:{$regex:i}}};e.collectionService.querySettings.setValue(a)}else{const{[e.field]:a,...u}=o.filter||{};e.collectionService.querySettings.setValue({...o,filter:u})}s(!1)};return l(l,null,l(nn,{onSubmit:r,onClear:r,service:e.collectionService,fieldName:e.field}),l("div",{className:"header-content",style:{display:"flex",width:"100%",height:"48px",justifyContent:"space-between",alignItems:"center",gap:"8px",overflow:"hide"}},l("div",{style:{paddingLeft:"0.5em"}},e.field),l("div",{className:"header-controls",style:{display:"flex",justifyContent:"center",alignItems:"center",paddingRight:"0.5em"}},l(tn,{onclick:()=>{s(!0)},service:e.collectionService,fieldName:e.field}),l(en,{collectionService:e.collectionService,field:e.field}))))}}),Ce=y({shadowDomName:"shade-loader",render:({element:e,props:t,injector:n})=>{const{theme:s}=n.getInstance(E);e.style.display="inline-block",e.style.transformOrigin="center",e.style.opacity="0";const{delay:r=500}=t,{borderWidth:i=15}=t,{borderColor:o=s.palette.primary.main}=t;return setTimeout(()=>{w(e,[{opacity:"0"},{opacity:"1"}],{duration:500,delay:r,fill:"forwards"}),w(e.firstElementChild,[{transform:"rotate(0deg)"},{transform:"rotate(180deg)"},{transform:"rotate(360deg)"}],{duration:1500,easing:"ease-in-out",iterations:1/0})},1),l("div",{style:{position:"relative",width:`calc(100% - ${i*2}px)`,height:`calc(100% - ${i*2}px)`,border:`${i}px solid rgba(128,128,128,0.1)`,borderBottom:`${i}px solid ${o}`,borderRadius:"50%"}})}}),sn=y({shadowDomName:"shades-data-grid-row",render:({props:e,element:t,useObservable:n,injector:s})=>{const{entry:r,rowComponents:i,columns:o,service:a}=e,{theme:u}=s.getInstance(E),c=f=>{f.includes(r)?(t.classList.add("selected"),A(t,{style:e.selectedRowStyle||{backgroundColor:u.background.default}}),t.setAttribute("aria-selected","true")):(t.classList.remove("selected"),A(t,{style:e.unselectedRowStyle||{backgroundColor:"transparent"}}),t.setAttribute("aria-selected","false"))},[d]=n("isSelected",a.selection,c,!0);c(d);const[h]=n("focus",a.focusedEntry,f=>{var g,m,p,b;if(f===e.entry){A(t,{style:e.focusedRowStyle||{boxShadow:`0 0 0 1px ${u.palette.primary.main}`,fontWeight:"bolder"}}),t.classList.add("focused");const x=((m=(g=t.closest("table"))==null?void 0:g.querySelector("th"))==null?void 0:m.getBoundingClientRect().height)||42,C=t.closest(".shade-grid-wrapper"),V=t.offsetTop-x,S=C.scrollTop;V<S&&C.scrollTo({top:V,behavior:"smooth"});const M=((b=(p=t.closest("shade-data-grid"))==null?void 0:p.querySelector("shade-data-grid-footer"))==null?void 0:b.getBoundingClientRect().height)||42,D=C.clientHeight-M,N=t.offsetTop+t.clientHeight;N>D&&C.scrollTo({top:N-D,behavior:"smooth"})}else t.classList.remove("focused"),A(t,{style:e.unfocusedRowStyle||{boxShadow:"none",fontWeight:"inherit"}})},!0);return t.style.display="table-row",t.style.cursor="default",t.style.userSelect="none",d!=null&&d.includes(r)&&(t.setAttribute("aria-selected","true"),t.classList.add("selected")),h===r&&t.classList.add("focused"),t.setAttribute("aria-selected",(d==null?void 0:d.includes(r).toString())||"false"),l(l,null,o.map(f=>{var g,m;return l("td",{style:{padding:"0.5em"},onclick:p=>{var b;return(b=e.onRowClick)==null?void 0:b.call(e,r,p)},ondblclick:p=>{var b;return(b=e.onRowDoubleClick)==null?void 0:b.call(e,r,p)}},((g=i==null?void 0:i[f])==null?void 0:g.call(i,r,{selection:d,focus:h}))||((m=i==null?void 0:i.default)==null?void 0:m.call(i,r,{selection:d,focus:h}))||l("span",null,r[f]))}))}}),on=y({shadowDomName:"shade-data-grid-body",render:({props:e,element:t,useObservable:n})=>{var i,o;t.style.display="table-row-group";const[s]=n("data",e.service.data),[r]=n("isLoading",e.service.isLoading);return r?l("div",{style:{display:"flex",height:"100%",justifyContent:"center",alignItems:"center",width:"100%"}},e.loaderComponent||l(Ce,{style:{height:"128px",width:"128px"}})):(i=s==null?void 0:s.entries)!=null&&i.length?l(l,null,(o=s==null?void 0:s.entries)==null?void 0:o.map(a=>l(sn,{columns:e.columns,entry:a,service:e.service,rowComponents:e.rowComponents,onRowClick:e.onRowClick,onRowDoubleClick:e.onRowDoubleClick,focusedRowStyle:e.focusedRowStyle,unfocusedRowStyle:e.unfocusedRowStyle,selectedRowStyle:e.selectedRowStyle,unselectedRowStyle:e.unselectedRowStyle}))):e.emptyComponent||l("div",null," - No Data - ")}}),an=[10,20,25,50,100,1/0],ln=y({shadowDomName:"shade-data-grid-footer",render:({props:e,injector:t,useObservable:n})=>{const{theme:s}=t.getInstance(E),[r]=n("dataUpdater",e.service.data),[i]=n("querySettings",e.service.querySettings),o=i.top||1/0,a=i.skip||0,u=Math.ceil(a)/(o||1),c=o;return l("div",{className:"pager",style:{backdropFilter:"blur(10px)",color:s.text.secondary,position:"sticky",bottom:"0",display:"flex",justifyContent:"flex-end",padding:"1em",alignItems:"center"}},c!==1/0&&l("div",null,"Goto page",l("select",{style:{margin:"0 1em"},onchange:d=>{const h=parseInt(d.target.value,10),f=e.service.querySettings.getValue();e.service.querySettings.setValue({...f,skip:(f.top||0)*h})}},[...new Array(Math.ceil(r.count/(e.service.querySettings.getValue().top||1/0)))].map((d,h)=>l("option",{value:h.toString(),selected:u===h},(h+1).toString())))),l("div",null,"Show",l("select",{style:{margin:"0 1em"},onchange:d=>{const h=parseInt(d.currentTarget.value,10);e.service.querySettings.setValue({...i,top:h,skip:u*h})}},an.map(d=>l("option",{value:d.toString(),selected:d===c},d.toString()))),"items per page"))}});class Qe{dispose(){window.removeEventListener("click",this.clickOutsideListener,!0)}constructor(t,n){this.element=t,this.onClickAway=n,this.clickOutsideListener=(s=>{s.target&&!this.element.contains(s.target)&&this.onClickAway()}).bind(this),window.addEventListener("click",this.clickOutsideListener,!0)}}y({shadowDomName:"shade-data-grid",constructed:({props:e})=>{const t=n=>e.service.handleKeyDown(n);return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},render:({props:e,injector:t,useDisposable:n,element:s})=>{var a,u,c;const r=t.getInstance(E),{theme:i}=r;n("clickAway",()=>new Qe(s,()=>{e.service.hasFocus.setValue(!1)}));const o={backdropFilter:"blur(12px) saturate(180%)",color:i.text.secondary,height:"38px",alignItems:"center",borderRadius:"2px",top:"2px",position:"sticky",fontVariant:"all-petite-caps",zIndex:"1",boxShadow:"rgba(0, 0, 0, 0.2) 1px 1px 1px 2px",...(a=e.styles)==null?void 0:a.header};return l("div",{className:"shade-grid-wrapper",style:{...(u=e.styles)==null?void 0:u.wrapper,width:"100%",height:"100%",overflow:"auto",zIndex:"1"},onclick:()=>{e.service.hasFocus.setValue(!0)},ariaMultiSelectable:"true"},l("table",{style:{width:"100%",maxHeight:"calc(100% - 4em)",position:"relative"}},l("thead",null,l("tr",null,e.columns.map(d=>{var h,f,g,m;return l("th",{style:o},((f=(h=e.headerComponents)==null?void 0:h[d])==null?void 0:f.call(h,d))||((m=(g=e.headerComponents)==null?void 0:g.default)==null?void 0:m.call(g,d))||l(rn,{field:d,collectionService:e.service}))}))),l(on,{columns:e.columns,service:e.service,rowComponents:e.rowComponents,onRowClick:(d,h)=>e.service.handleRowClick(d,h),onRowDoubleClick:d=>e.service.handleRowDoubleClick(d),style:(c=e.styles)==null?void 0:c.cell,focusedRowStyle:e.focusedRowStyle,selectedRowStyle:e.selectedRowStyle,unfocusedRowStyle:e.unfocusedRowStyle,unselectedRowStyle:e.unselectedRowStyle,emptyComponent:e.emptyComponent,loaderComponent:e.loaderComponent})),l(ln,{service:e.service}))}});y({shadowDomName:"shades-data-grid-selection-cell",render:({props:e,useObservable:t,element:n})=>{const[s]=t("selection",e.service.selection,i=>{n.querySelector("input").checked=i.includes(e.entry)}),r=s.includes(e.entry);return l("input",{onchange:()=>{e.service.toggleSelection(e.entry)},type:"checkbox",checked:r})}});y({shadowDomName:"shade-fab",elementBase:HTMLButtonElement,elementBaseName:"button",render:({props:e,children:t,element:n})=>(R(n,{...e,style:{position:"fixed",bottom:"32px",right:"32px",background:"gray",width:"64px",height:"64px",display:"flex",justifyContent:"center",alignItems:"center",borderRadius:"50%",boxShadow:"2px 2px 4px rgba(0,0,0,0.3)",cursor:"pointer",...e==null?void 0:e.style}}),l(l,null,t))});y({shadowDomName:"shade-grid",render:({props:e,injector:t})=>{var r,i;const{theme:n}=t.getInstance(E),s={padding:"0 0.51em",backgroundColor:n.background.paper,color:n.text.secondary,borderRadius:"2px",top:"0",position:"sticky",cursor:"pointer",fontVariant:"all-petite-caps",...(r=e.styles)==null?void 0:r.header};return l("div",{className:"shade-grid-wrapper",style:{...(i=e.styles)==null?void 0:i.wrapper,width:"100%",height:"100%",overflow:"auto"}},l("table",{style:{width:"100%",position:"relative"}},l("thead",null,l("tr",null,e.columns.map(o=>{var a,u,c,d;return l("th",{style:s},((u=(a=e.headerComponents)==null?void 0:a[o])==null?void 0:u.call(a,o))||((d=(c=e.headerComponents)==null?void 0:c.default)==null?void 0:d.call(c,o))||l(l,null,o))}))),l("tbody",null,e.entries.map(o=>l("tr",null,e.columns.map(a=>{var u,c,d,h,f;return l("td",{style:(u=e.styles)==null?void 0:u.cell},((d=(c=e.rowComponents)==null?void 0:c[a])==null?void 0:d.call(c,o))||((f=(h=e.rowComponents)==null?void 0:h.default)==null?void 0:f.call(h,o))||l(l,null,o[a]))}))))))}});y({shadowDomName:"shade-modal",render:({props:e,children:t,useObservable:n,element:s})=>{var i;const[r]=n("isVisible",e.isVisible);return r&&((i=e.showAnimation)==null||i.call(e,s)),r?l("div",{className:"shade-backdrop",onclick:async()=>{var o,a;await((o=e.hideAnimation)==null?void 0:o.call(e,s)),(a=e.onClose)==null||a.call(e)},style:{width:"100%",height:"100%",display:"block",position:"fixed",top:"0",left:"0",...e.backdropStyle}},t):null}});var cn=globalThis&&globalThis.__decorate||function(e,t,n,s){var r=arguments.length,i=r<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,n):s,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(r<3?o(i):r>3?o(t,n,i):o(t,n))||i);return r>3&&i&&Object.defineProperty(t,n,i),i};let Q=class{constructor(){this.onNotyAdded=new v,this.onNotyRemoved=new v,this.notys=new v([]),this.addNoty=t=>{this.onNotyAdded.setValue(t),this.notys.setValue([...this.notys.getValue(),t])},this.removeNoty=t=>{this.onNotyRemoved.setValue(t),this.notys.setValue(this.notys.getValue().filter(n=>n!==t))}}};Q=cn([_({lifetime:"singleton"})],Q);const dn=e=>{switch(e){case"error":return 0;case"warning":return 0;case"success":return 5e3;case"info":return 2e4;default:return 0}},Re=y({shadowDomName:"shade-noty",constructed:({element:e})=>{setTimeout(()=>{const t=e.scrollHeight||80;w(e,[{opacity:"0",height:"0px"},{opacity:"1",height:`${t}px`}],{fill:"forwards",duration:700,easing:"cubic-bezier(0.190, 1.000, 0.220, 1.000)"})})},render:({props:e,injector:t,element:n})=>{const s=t.getInstance(E),r=s.theme.palette[e.model.type],i=s.getTextColor(r.dark),o=s.getTextColor(r.main),a=async()=>{await w(n,[{opacity:"1",height:`${(n==null?void 0:n.scrollHeight)||0}px`,margin:"8px 8px"},{opacity:"0",height:"0px",margin:"0px 8px"}],{fill:"forwards",duration:700,easing:"cubic-bezier(0.190, 1.000, 0.220, 1.000)"}),e.onDismiss()},u=e.model.timeout||dn(e.model.type);return u&&setTimeout(a,u),R(n,{className:`noty ${e.model.type}`,style:{width:"300px",display:"flex",flexDirection:"column",height:"0px",backgroundColor:r.main,color:o,margin:"8px",overflow:"hidden",borderRadius:"6px",boxShadow:"1px 3px 6px rgba(0,0,0,0.3)"}}),l(l,null,l("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0px 6px 0px 16px",backgroundColor:r.dark,color:i,fontSize:"1.3em"}},l("h5",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",margin:"0",fontSize:".7em"},title:e.model.title},e.model.title),l(F,{style:{margin:"4px 0",padding:"0 4px",fontSize:"12px"},className:"dismissNoty",onclick:a,title:"Close Notification",variant:"contained",color:e.model.type},"âœ–")),l("div",{style:{padding:"16px 16px"}},e.model.body))}}),un=y({shadowDomName:"shade-noty-list",render:({useObservable:e,injector:t,element:n})=>{const s=t.getInstance(Q);R(n,{style:{position:"fixed",bottom:"1em",right:"1em",display:"flex",flexDirection:"column"}});const r=s.notys.getValue();return e("addNoty",s.onNotyAdded,i=>n.append(l(Re,{model:i,onDismiss:()=>s.removeNoty(i)}))),e("removeNoty",s.onNotyRemoved,i=>{n.querySelectorAll("shade-noty").forEach(o=>{o.props.model===i&&o.remove()})}),l(l,null,r.map(i=>l(Re,{model:i,onDismiss:()=>t.getInstance(Q).removeNoty(i)})))}}),hn=y({shadowDomName:"shade-paper",render:({injector:e,props:t,children:n,element:s})=>{const r=e.getInstance(E),{elevation:i=1}=t;return R(s,{...t,style:{borderRadius:"3px",boxShadow:i?`1px ${i}px ${i}px rgba(0,0,0,0.3)`:"",backgroundColor:r.theme.background.paper,color:r.theme.text.secondary,margin:"8px",padding:"6px 16px",...t==null?void 0:t.style}}),l(l,null,n)}});y({shadowDomName:"shade-skeleton",render:({element:e,props:t})=>{const{delay:n=1500}=t;return setTimeout(()=>{w(e,[{opacity:0},{opacity:1}],{fill:"forwards",duration:300,easing:"ease-out",delay:n}).then(()=>{w(e,[{backgroundPosition:"0% 50%"},{backgroundPosition:"100% 50%"},{backgroundPosition:"0% 50%"}],{duration:1e4,iterations:1/0})})}),A(e,{style:{opacity:"0",display:"inline-block",background:"linear-gradient(-45deg, rgba(128,128,128,0.1), rgba(128,128,128,0.3), rgba(128,128,128,0.1))",backgroundSize:"400% 400%",width:"100%",height:"100%",minHeight:"1em"}}),null}});var fn=globalThis&&globalThis.__decorate||function(e,t,n,s){var r=arguments.length,i=r<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,n):s,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(r<3?o(i):r>3?o(t,n,i):o(t,n))||i);return r>3&&i&&Object.defineProperty(t,n,i),i},gn=globalThis&&globalThis.__metadata||function(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)};let ge=class{dispose(){window.removeEventListener("keyup",this.keyPressListener),window.removeEventListener("click",this.clickOutsideListener),this.isOpened.dispose(),this.isLoading.dispose(),this.term.dispose(),this.selectedIndex.dispose(),this.currentSuggestions.dispose(),this.onSelectSuggestion.dispose()}selectSuggestion(t=this.selectedIndex.getValue()){const n=this.currentSuggestions.getValue()[t];this.isOpened.setValue(!1),this.onSelectSuggestion.setValue(n.entry)}constructor(t,n){this.getEntries=t,this.getSuggestionEntry=n,this.isOpened=new v(!1),this.isLoading=new v(!1),this.term=new v(""),this.selectedIndex=new v(0),this.currentSuggestions=new v([]),this.onSelectSuggestion=new v,this.keyPressListener=(s=>{s.key==="Escape"&&this.isOpened.setValue(!1)}).bind(this),this.clickOutsideListener=(s=>{this.element&&this.isOpened.getValue()&&s.target.closest(this.element.tagName)!==this.element&&this.isOpened.setValue(!1)}).bind(this),this.getSuggestion=qe(async s=>{var r;try{if(((r=this.lastGetSuggestionOptions)==null?void 0:r.term)===s.term)return;const i=JSON.stringify(this.currentSuggestions.getValue()[this.selectedIndex.getValue()]);this.isLoading.setValue(!0),this.lastGetSuggestionOptions=s;const o=await this.getEntries(s.term);this.isOpened.setValue(!0),this.currentSuggestions.setValue(o.map(a=>({entry:a,suggestion:this.getSuggestionEntry(a)}))),this.selectedIndex.setValue(Math.max(0,this.currentSuggestions.getValue().findIndex(a=>JSON.stringify(a)===i)))}finally{this.isLoading.setValue(!1)}},250),window.addEventListener("keyup",this.keyPressListener,!0),window.addEventListener("click",this.clickOutsideListener,!0)}};ge=fn([_({lifetime:"singleton"}),gn("design:paramtypes",[Function,Function])],ge);const mn=y({shadowDomName:"shades-suggest-input",render:({element:e,props:t,useObservable:n,injector:s})=>{const{theme:r}=s.getInstance(E);return e.style.width="100%",e.style.overflow="hidden",n("isOpened",t.manager.isOpened,i=>{const o=e.firstChild;i?o.focus():o.value=""},!0),l("input",{autofocus:!0,style:{color:r.text.primary,outline:"none",padding:"1em",background:"transparent",border:"none",display:"inline-flex",width:"calc(100% - 2em)"}})}}),pn=y({shadowDomName:"shade-suggest-suggestion-list",render:({element:e,props:t,injector:n,useObservable:s})=>{var c;const{manager:r}=t,{theme:i}=n.getInstance(E),[o]=s("suggestions",r.currentSuggestions),[a]=s("selectedIndex",r.selectedIndex,d=>{[...e.querySelectorAll(".suggestion-item")].map((h,f)=>{f===d?(h.style.background=i.background.paper,h.style.fontWeight="bolder"):(h.style.background=i.background.default,h.style.fontWeight="normal")})},!0),[u]=s("isOpened",r.isOpened,async d=>{var f;const h=e.firstElementChild;d?(h.style.zIndex="1",h.style.width=`calc(${Math.round(((f=e.parentElement)==null?void 0:f.getBoundingClientRect().width)||200)}px - 3em)`,await w(h,[{opacity:0,transform:"translate(0, -50px)"},{opacity:1,transform:"translate(0, 0)"}],{fill:"forwards",duration:500})):(await w(h,[{opacity:1,transform:"translate(0, 0)"},{opacity:0,transform:"translate(0, -50px)"}],{fill:"forwards",duration:200}),h.style.zIndex="-1")});return l("div",{className:"suggestion-items-container",style:{borderTop:"none",position:"absolute",borderRadius:"0px 0px 5px 5px",marginLeft:"14px",overflow:"hidden",zIndex:"1",left:"auto",backgroundColor:i.background.paper,color:i.text.secondary,boxShadow:"3px 3px 5px rgba(0,0,0,0.3)",backdropFilter:"blur(15px)",width:`calc(${Math.round(((c=e.parentElement)==null?void 0:c.getBoundingClientRect().width)||200)}px - 3em)`}},o.map((d,h)=>l("div",{className:"suggestion-item",onclick:()=>{u&&r.selectSuggestion(h)},style:{padding:"1em",cursor:"default",background:h===a?i.background.paper:i.background.default,fontWeight:h===a?"bolder":"normal"}},d.suggestion.element)))}});y({shadowDomName:"shade-suggest",render:({props:e,injector:t,element:n,useDisposable:s,useObservable:r})=>{n.style.flexGrow="1";const i=s("manager",()=>new ge(e.getEntries,e.getSuggestionEntry)),{theme:o}=t.getInstance(E),a=n.querySelector(".input-container");return i.element=n,i.isOpened.subscribe(u=>{const c=n.querySelector(".close-suggestions"),d=n.querySelector(".post-controls");u?(w(c,[{opacity:0},{opacity:1}],{duration:500,fill:"forwards"}),w(d,[{width:"0px"},{width:"50px"}],{duration:100,fill:"forwards"}),w(a,[{background:"transparent"},{background:o.background.default}],{duration:500,fill:"forwards",easing:"cubic-bezier(0.050, 0.570, 0.840, 1.005)"})):(w(c,[{opacity:1},{opacity:0}],{duration:500,fill:"forwards"}),w(d,[{width:"50px"},{width:"0px"}],{duration:500,fill:"forwards",delay:300}),w(a,[{background:o.background.default},{background:"transparent"}],{duration:300,fill:"forwards",easing:"cubic-bezier(0.000, 0.245, 0.190, 0.790)"}))}),i.isLoading.subscribe(async u=>{const c=n.querySelector("shade-loader");u?w(c,[{opacity:0},{opacity:1}],{duration:100,fill:"forwards"}):w(c,[{opacity:1},{opacity:0}],{duration:100,fill:"forwards"})}),r("onSelectSuggestion",i.onSelectSuggestion,e.onSelectSuggestion),l("div",{style:{display:"flex",flexDirection:"column"},onkeyup:u=>{if(u.key==="Enter"){u.preventDefault(),i.selectSuggestion();return}u.key==="ArrowUp"&&(u.preventDefault(),i.selectedIndex.setValue(Math.max(0,i.selectedIndex.getValue()-1))),u.key==="ArrowDown"&&(u.preventDefault(),i.selectedIndex.setValue(Math.min(i.selectedIndex.getValue()+1,i.currentSuggestions.getValue().length-1))),i.getSuggestion({injector:t,term:u.target.value})}},l("div",{className:"input-container",style:{display:"flex",alignItems:"center",justifyContent:"flex-end",padding:"0 1em",borderRadius:"5px",position:"relative",background:"rgba(128,128,128,0.1)",...e.style}},l("div",{className:"term-icon",style:{cursor:"pointer",color:"#aaa",fontWeight:"bolder",textShadow:"0 0 1px #aaa"},onclick:()=>i.isOpened.setValue(!0)},e.defaultPrefix),l(mn,{manager:i}),l("div",{className:"post-controls",style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:i.isOpened.getValue()?"50px":"0px",overflow:"hidden"}},l(Ce,{style:{width:"20px",height:"20px",opacity:i.isLoading.getValue()?"1":"0"},delay:0,borderWidth:4}),l("div",{className:"close-suggestions",onclick:()=>i.isOpened.setValue(!1),style:{width:"20px",height:"20px",opacity:i.isOpened.getValue()?"1":"0",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"}},"âœ–"))),l(pn,{manager:i}))}});const yn=y({shadowDomName:"shade-tab-header",render:({children:e,element:t,injector:n,props:s})=>{const{theme:r}=n.getInstance(E),{isActive:i}=s;return R(t,{style:{padding:"1em 2.5em",cursor:"pointer",transition:"box-shadow 1s linear",fontWeight:i?"bolder":"inherit",background:i?r.background.paper:r.background.default,color:i?r.text.primary:r.text.secondary,boxShadow:i?`inset 0 -2px 0 ${r.palette.primary.main}`:"none"},onclick:s.onActivate}),l(l,null,e)}});y({shadowDomName:"shade-tabs",render:({props:e,element:t,useObservable:n,injector:s})=>{R(t,{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",...e.containerStyle}});const[r]=n("updateLocation",s.getInstance(q).onLocationHashChanged),i=e.tabs.find(o=>o.hash===r.replace("#",""));return l(l,null,l("div",{className:"shade-tabs-header-container",style:{display:"inline-flex",borderRadius:"5px 5px 0 0",overflow:"hidden",flexShrink:"0"}},e.tabs.map(o=>l(yn,{isActive:o===i,onActivate:()=>{window.history.pushState({},"",`#${o.hash}`)}},o.header))),i==null?void 0:i.component)}});var vn=globalThis&&globalThis.__decorate||function(e,t,n,s){var r=arguments.length,i=r<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,n):s,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(r<3?o(i):r>3?o(t,n,i):o(t,n))||i);return r>3&&i&&Object.defineProperty(t,n,i),i},bn=globalThis&&globalThis.__metadata||function(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)};let me=class{dispose(){window.removeEventListener("keyup",this.keyPressListener),this.isOpened.dispose(),this.isLoading.dispose(),this.term.dispose(),this.selectedIndex.dispose(),this.currentSuggestions.dispose()}selectSuggestion(t,n=this.selectedIndex.getValue()){const s=this.currentSuggestions.getValue()[n];this.isOpened.setValue(!1),s.onSelected({injector:t})}constructor(t){this.commandProviders=t,this.isOpened=new v(!1),this.isLoading=new v(!1),this.term=new v(""),this.selectedIndex=new v(0),this.currentSuggestions=new v([]),this.keyPressListener=(n=>{n.key&&n.key.toLowerCase()==="p"&&n.ctrlKey&&(this.isOpened.setValue(!0),this.currentSuggestions.setValue([])),n.key==="Escape"&&this.isOpened.setValue(!1)}).bind(this),this.getSuggestion=qe(async n=>{var s;try{if(((s=this.lastGetSuggestionOptions)==null?void 0:s.term)===n.term)return;this.isLoading.setValue(!0),this.lastGetSuggestionOptions=n,this.currentSuggestions.setValue([]),this.selectedIndex.setValue(0),await Promise.all(this.commandProviders.map(async r=>{const i=await r(n);this.lastGetSuggestionOptions===n&&this.currentSuggestions.setValue([...this.currentSuggestions.getValue(),...i].sortBy("score"))}))}finally{this.isLoading.setValue(!1)}},250),window.addEventListener("keyup",this.keyPressListener,!0)}};me=vn([_({lifetime:"singleton"}),bn("design:paramtypes",[Array])],me);const wn=y({shadowDomName:"shades-command-palette-input",render:({element:e,props:t,injector:n,useObservable:s})=>{const{theme:r}=n.getInstance(E),{manager:i}=t;return s("isOpened",i.isOpened,async o=>{const a=e.firstChild;a&&(o?(a.value="",await w(e,[{width:"0%"},{width:"100%"}],{duration:300,fill:"forwards",easing:"cubic-bezier(0.595, 0.425, 0.415, 0.845)"}),a.focus()):(await w(e,[{width:"100%"},{width:"0%"}],{duration:300,fill:"forwards",easing:"cubic-bezier(0.595, 0.425, 0.415, 0.845)"}),a.value=""))},!0),e.style.width=i.isOpened.getValue()?"100%":"0%",e.style.overflow="hidden",l("input",{autofocus:!0,style:{color:r.text.primary,outline:"none",padding:"1em",background:"transparent",border:"none",display:"inline-flex",width:"calc(100% - 2em)"}})}}),xn=y({shadowDomName:"shade-command-palette-suggestion-list",render:({element:e,injector:t,props:n,useObservable:s})=>{var c;const{manager:r}=n,{theme:i}=t.getInstance(E),[o]=s("suggestions",n.manager.currentSuggestions),[a]=s("selectedIndex",n.manager.selectedIndex,d=>{[...e.querySelectorAll(".suggestion-item")].map((h,f)=>{f===d?(h.style.background=i.background.paper,h.style.fontWeight="bolder"):(h.style.background=i.background.default,h.style.fontWeight="normal")})}),[u]=s("isOpenedAtRender",n.manager.isOpened,async d=>{var f;const h=e.firstElementChild;d?(h.style.display="initial",h.style.zIndex="1",h.style.width=`calc(${Math.round(((f=e.parentElement)==null?void 0:f.getBoundingClientRect().width)||200)}px - 3em)`,await w(h,[{opacity:0,transform:"translate(0, -50px)"},{opacity:1,transform:"translate(0, 0)"}],{fill:"forwards",duration:500})):(await w(h,[{opacity:1,transform:"translate(0, 0)"},{opacity:0,transform:"translate(0, -50px)"}],{fill:"forwards",duration:200}),h.style.zIndex="-1",h.style.display="none")});return l("div",{className:"suggestion-items-container",style:{borderTop:"none",position:"absolute",opacity:r.isOpened.getValue()?"1":"0",borderRadius:"0px 0px 5px 5px",marginLeft:"14px",overflow:"hidden",overflowY:"auto",maxHeight:`${window.innerHeight*.8}px`,zIndex:"1",left:"auto",backgroundColor:i.background.paper,boxShadow:"3px 3px 5px rgba(0,0,0,0.3)",width:`calc(${Math.round(((c=e.parentElement)==null?void 0:c.getBoundingClientRect().width)||200)}px - 3em)`,...n.fullScreenSuggestions?{left:"0",width:"calc(100% - 42px)"}:{}}},o.map((d,h)=>l("div",{className:"suggestion-item",onclick:()=>{u&&r.selectSuggestion(t,h)},style:{padding:"1em",cursor:"default",background:h===a?i.background.paper:i.background.default,fontWeight:h===a?"bolder":"normal"}},d.element)))}});y({shadowDomName:"shade-command-palette",render:({props:e,injector:t,element:n,useState:s,useDisposable:r,useObservable:i})=>{n.style.flexGrow="1";const[o]=s("manager",new me(e.commandProviders)),{theme:a}=t.getInstance(E);r("clickAwayService",()=>new Qe(n,()=>o.isOpened.setValue(!1)));const[u]=i("isLoading",o.isLoading,async h=>{const f=n.querySelector(".loader-container");h?w(f,[{opacity:0},{opacity:1}],{duration:100,fill:"forwards"}):w(f,[{opacity:1},{opacity:0}],{duration:100,fill:"forwards"})}),[c,d]=i("isOpened",o.isOpened,h=>{{const f=n.querySelector(".close-suggestions"),g=n.querySelector(".post-controls"),m=n.querySelector(".input-container");h?(w(f,[{opacity:0},{opacity:1}],{duration:500,fill:"forwards"}),w(g,[{width:"0px"},{width:"50px"}],{duration:100,fill:"forwards"}),w(m,[{background:"transparent"},{background:a.background.default}],{duration:500,fill:"forwards",easing:"cubic-bezier(0.050, 0.570, 0.840, 1.005)"})):(w(f,[{opacity:1},{opacity:0}],{duration:500,fill:"forwards"}),w(g,[{width:"50px"},{width:"0px"}],{duration:500,fill:"forwards",delay:300}),w(m,[{background:a.background.default},{background:"transparent"}],{duration:300,fill:"forwards",easing:"cubic-bezier(0.000, 0.245, 0.190, 0.790)"}))}});return l("div",{style:{display:"flex",flexDirection:"column"},onkeyup:h=>{if(h.key==="Enter"){h.preventDefault(),o.selectSuggestion(t);return}h.key==="ArrowUp"&&(h.preventDefault(),o.selectedIndex.setValue(Math.max(0,o.selectedIndex.getValue()-1))),h.key==="ArrowDown"&&(h.preventDefault(),o.selectedIndex.setValue(Math.min(o.selectedIndex.getValue()+1,o.currentSuggestions.getValue().length-1))),o.getSuggestion({injector:t,term:h.target.value})}},l("div",{className:"input-container",style:{display:"flex",alignItems:"center",justifyContent:"flex-end",padding:"0 1em",borderRadius:"5px",position:"relative",...e.style}},l("div",{className:"term-icon",style:{cursor:"pointer",color:"#aaa",fontWeight:"bolder",textShadow:"0 0 1px #aaa"},onclick:()=>d(!0)},e.defaultPrefix),l(wn,{manager:o}),l("div",{className:"post-controls",style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:c?"50px":"0px",overflow:"hidden"}},l("div",{className:"loader-container",style:{width:"20px",height:"20px",opacity:u?"1":"0"}},l(Ce,{style:{width:"100%",height:"100%"}})),l("div",{className:"close-suggestions",onclick:()=>d(!1),style:{width:"20px",height:"20px",opacity:o.isOpened.getValue()?"1":"0",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"}},"âœ–"))),l(xn,{manager:o,fullScreenSuggestions:e.fullScreenSuggestions}))}});y({shadowDomName:"shades-wizard",render:({props:e,useState:t})=>{const[n,s]=t("currentPage",0),r=e.steps[n];return l("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%"}},l(hn,{style:{maxWidth:"100%",maxHeight:"100%"},elevation:3,onclick:i=>i.stopPropagation()},l(r,{currentPage:n,maxPages:e.steps.length,onNext:()=>{var i;n<e.steps.length-1?s(n+1):(i=e.onFinish)==null||i.call(e)},onPrev:()=>{n>0&&s(n-1)}})))}});const ee=(e,t)=>{const n=t.x-e.x,s=t.y-e.y;return Math.sqrt(n*n+s*s)},Sn=(e,t)=>{const n=t.x-e.x,s=t.y-e.y;return On(Math.atan2(s,n))},Cn=(e,t,n)=>{const s={x:0,y:0};return n=pe(n),s.x=e.x-t*Math.cos(n),s.y=e.y-t*Math.sin(n),s},pe=e=>e*(Math.PI/180),On=e=>e*(180/Math.PI),En=e=>isNaN(e.buttons)?e.pressure!==0:e.buttons!==0,le=new Map,Me=e=>{le.has(e)&&clearTimeout(le.get(e)),le.set(e,setTimeout(e,100))},ie=(e,t,n)=>{const s=t.split(/[ ,]+/g);let r;for(let i=0;i<s.length;i+=1)r=s[i],e.addEventListener?e.addEventListener(r,n,!1):e.attachEvent&&e.attachEvent(r,n)},Le=(e,t,n)=>{const s=t.split(/[ ,]+/g);let r;for(let i=0;i<s.length;i+=1)r=s[i],e.removeEventListener?e.removeEventListener(r,n):e.detachEvent&&e.detachEvent(r,n)},Xe=e=>(e.preventDefault(),e.type.match(/^touch/)?e.changedTouches:e),Fe=()=>{const e=window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,t=window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;return{x:e,y:t}},je=(e,t)=>{t.top||t.right||t.bottom||t.left?(e.style.top=t.top,e.style.right=t.right,e.style.bottom=t.bottom,e.style.left=t.left):(e.style.left=t.x+"px",e.style.top=t.y+"px")},Oe=(e,t,n)=>{const s=Ye(e);for(let r in s)if(s.hasOwnProperty(r))if(typeof t=="string")s[r]=t+" "+n;else{let i="";for(let o=0,a=t.length;o<a;o+=1)i+=t[o]+" "+n+", ";s[r]=i.slice(0,-2)}return s},In=(e,t)=>{const n=Ye(e);for(let s in n)n.hasOwnProperty(s)&&(n[s]=t);return n},Ye=e=>{const t={};return t[e]="",["webkit","Moz","o"].forEach(function(s){t[s+e.charAt(0).toUpperCase()+e.slice(1)]=""}),t},ce=(e,t)=>{for(let n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},Dn=(e,t)=>{const n={};for(let s in e)e.hasOwnProperty(s)&&t.hasOwnProperty(s)?n[s]=t[s]:e.hasOwnProperty(s)&&(n[s]=e[s]);return n},ye=(e,t)=>{if(e.length)for(let n=0,s=e.length;n<s;n+=1)t(e[n]);else t(e)},kn=(e,t,n)=>({x:Math.min(Math.max(e.x,t.x-n),t.x+n),y:Math.min(Math.max(e.y,t.y-n),t.y+n)});var Tn="ontouchstart"in window,_n=!!window.PointerEvent,Vn=!!window.MSPointerEvent,U={touch:{start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},mouse:{start:"mousedown",move:"mousemove",end:"mouseup"},pointer:{start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"},MSPointer:{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}},W,X={};_n?W=U.pointer:Vn?W=U.MSPointer:Tn?(W=U.touch,X=U.mouse):W=U.mouse;function j(){}j.prototype.on=function(e,t){var n=this,s=e.split(/[ ,]+/g),r;n._handlers_=n._handlers_||{};for(var i=0;i<s.length;i+=1)r=s[i],n._handlers_[r]=n._handlers_[r]||[],n._handlers_[r].push(t);return n};j.prototype.off=function(e,t){var n=this;return n._handlers_=n._handlers_||{},e===void 0?n._handlers_={}:t===void 0?n._handlers_[e]=null:n._handlers_[e]&&n._handlers_[e].indexOf(t)>=0&&n._handlers_[e].splice(n._handlers_[e].indexOf(t),1),n};j.prototype.trigger=function(e,t){var n=this,s=e.split(/[ ,]+/g),r;n._handlers_=n._handlers_||{};for(var i=0;i<s.length;i+=1)r=s[i],n._handlers_[r]&&n._handlers_[r].length&&n._handlers_[r].forEach(function(o){o.call(n,{type:r,target:n},t)})};j.prototype.config=function(e){var t=this;t.options=t.defaults||{},e&&(t.options=Dn(t.options,e))};j.prototype.bindEvt=function(e,t){var n=this;return n._domHandlers_=n._domHandlers_||{},n._domHandlers_[t]=function(){typeof n["on"+t]=="function"?n["on"+t].apply(n,arguments):console.warn('[WARNING] : Missing "on'+t+'" handler.')},ie(e,W[t],n._domHandlers_[t]),X[t]&&ie(e,X[t],n._domHandlers_[t]),n};j.prototype.unbindEvt=function(e,t){var n=this;return n._domHandlers_=n._domHandlers_||{},Le(e,W[t],n._domHandlers_[t]),X[t]&&Le(e,X[t],n._domHandlers_[t]),delete n._domHandlers_[t],this};function k(e,t){return this.identifier=t.identifier,this.position=t.position,this.frontPosition=t.frontPosition,this.collection=e,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(t),this.options.mode==="dynamic"&&(this.options.restOpacity=0),this.id=k.id,k.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}k.prototype=new j;k.constructor=k;k.id=0;k.prototype.buildEl=function(e){return this.ui={},this.options.dataOnly?this:(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front),this)};k.prototype.stylize=function(){if(this.options.dataOnly)return this;var e=this.options.fadeTime+"ms",t=In("borderRadius","50%"),n=Oe("transition","opacity",e),s={};return s.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},s.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:this.options.color,opacity:".5"},s.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:this.options.color,opacity:".5",transform:"translate(0px, 0px)"},ce(s.el,n),this.options.shape==="circle"&&ce(s.back,t),ce(s.front,t),this.applyStyles(s),this};k.prototype.applyStyles=function(e){for(var t in this.ui)if(this.ui.hasOwnProperty(t))for(var n in e[t])this.ui[t].style[n]=e[t][n];return this};k.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)?this:(this.options.zone.appendChild(this.ui.el),this)};k.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)?this:(this.options.zone.removeChild(this.ui.el),this)};k.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()};k.prototype.show=function(e){var t=this;return t.options.dataOnly||(clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.addToDom(),t.restCallback(),setTimeout(function(){t.ui.el.style.opacity=1},0),t.showTimeout=setTimeout(function(){t.trigger("shown",t.instance),typeof e=="function"&&e.call(this)},t.options.fadeTime)),t};k.prototype.hide=function(e){var t=this;if(t.options.dataOnly)return t;if(t.ui.el.style.opacity=t.options.restOpacity,clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.removeTimeout=setTimeout(function(){var n=t.options.mode==="dynamic"?"none":"block";t.ui.el.style.display=n,typeof e=="function"&&e.call(t),t.trigger("hidden",t.instance)},t.options.fadeTime),t.options.restJoystick){const n=t.options.restJoystick,s={};s.x=n===!0||n.x!==!1?0:t.instance.frontPosition.x,s.y=n===!0||n.y!==!1?0:t.instance.frontPosition.y,t.setPosition(e,s)}return t};k.prototype.setPosition=function(e,t){var n=this;n.frontPosition={x:t.x,y:t.y};var s=n.options.fadeTime+"ms",r={};r.front=Oe("transition",["transform"],s);var i={front:{}};i.front={transform:"translate("+n.frontPosition.x+"px,"+n.frontPosition.y+"px)"},n.applyStyles(r),n.applyStyles(i),n.restTimeout=setTimeout(function(){typeof e=="function"&&e.call(n),n.restCallback()},n.options.fadeTime)};k.prototype.restCallback=function(){var e=this,t={};t.front=Oe("transition","none",""),e.applyStyles(t),e.trigger("rested",e.instance)};k.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}};k.prototype.computeDirection=function(e){var t=e.angle.radian,n=Math.PI/4,s=Math.PI/2,r,i,o;if(t>n&&t<n*3&&!e.lockX?r="up":t>-n&&t<=n&&!e.lockY?r="left":t>-n*3&&t<=-n&&!e.lockX?r="down":e.lockY||(r="right"),e.lockY||(t>-s&&t<s?i="left":i="right"),e.lockX||(t>0?o="up":o="down"),e.force>this.options.threshold){var a={},u;for(u in this.direction)this.direction.hasOwnProperty(u)&&(a[u]=this.direction[u]);var c={};this.direction={x:i,y:o,angle:r},e.direction=this.direction;for(u in a)a[u]===this.direction[u]&&(c[u]=!0);if(c.x&&c.y&&c.angle)return e;(!c.x||!c.y)&&this.trigger("plain",e),c.x||this.trigger("plain:"+i,e),c.y||this.trigger("plain:"+o,e),c.angle||this.trigger("dir dir:"+r,e)}else this.resetDirection();return e};function I(e,t){var n=this;n.nipples=[],n.idles=[],n.actives=[],n.ids=[],n.pressureIntervals={},n.manager=e,n.id=I.id,I.id+=1,n.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},n.config(t),(n.options.mode==="static"||n.options.mode==="semi")&&(n.options.multitouch=!1),n.options.multitouch||(n.options.maxNumberOfNipples=1);const s=getComputedStyle(n.options.zone.parentElement);return s&&s.display==="flex"&&(n.parentIsFlex=!0),n.updateBox(),n.prepareNipples(),n.bindings(),n.begin(),n.nipples}I.prototype=new j;I.constructor=I;I.id=0;I.prototype.prepareNipples=function(){var e=this,t=e.nipples;t.on=e.on.bind(e),t.off=e.off.bind(e),t.options=e.options,t.destroy=e.destroy.bind(e),t.ids=e.ids,t.id=e.id,t.processOnMove=e.processOnMove.bind(e),t.processOnEnd=e.processOnEnd.bind(e),t.get=function(n){if(n===void 0)return t[0];for(var s=0,r=t.length;s<r;s+=1)if(t[s].identifier===n)return t[s];return!1}};I.prototype.bindings=function(){var e=this;e.bindEvt(e.options.zone,"start"),e.options.zone.style.touchAction="none",e.options.zone.style.msTouchAction="none"};I.prototype.begin=function(){var e=this,t=e.options;if(t.mode==="static"){var n=e.createNipple(t.position,e.manager.getIdentifier());n.add(),e.idles.push(n)}};I.prototype.createNipple=function(e,t){var n=this,s=n.manager.scroll,r={},i=n.options,o={x:n.parentIsFlex?s.x:s.x+n.box.left,y:n.parentIsFlex?s.y:s.y+n.box.top};if(e.x&&e.y)r={x:e.x-o.x,y:e.y-o.y};else if(e.top||e.right||e.bottom||e.left){var a=document.createElement("DIV");a.style.display="hidden",a.style.top=e.top,a.style.right=e.right,a.style.bottom=e.bottom,a.style.left=e.left,a.style.position="absolute",i.zone.appendChild(a);var u=a.getBoundingClientRect();i.zone.removeChild(a),r=e,e={x:u.left+s.x,y:u.top+s.y}}var c=new k(n,{color:i.color,size:i.size,threshold:i.threshold,fadeTime:i.fadeTime,dataOnly:i.dataOnly,restJoystick:i.restJoystick,restOpacity:i.restOpacity,mode:i.mode,identifier:t,position:e,zone:i.zone,frontPosition:{x:0,y:0},shape:i.shape});return i.dataOnly||(je(c.ui.el,r),je(c.ui.front,c.frontPosition)),n.nipples.push(c),n.trigger("added "+c.identifier+":added",c),n.manager.trigger("added "+c.identifier+":added",c),n.bindNipple(c),c};I.prototype.updateBox=function(){var e=this;e.box=e.options.zone.getBoundingClientRect()};I.prototype.bindNipple=function(e){var t=this,n,s=function(r,i){n=r.type+" "+i.id+":"+r.type,t.trigger(n,i)};e.on("destroyed",t.onDestroyed.bind(t)),e.on("shown hidden rested dir plain",s),e.on("dir:up dir:right dir:down dir:left",s),e.on("plain:up plain:right plain:down plain:left",s)};I.prototype.pressureFn=function(e,t,n){var s=this,r=0;clearInterval(s.pressureIntervals[n]),s.pressureIntervals[n]=setInterval((function(){var i=e.force||e.pressure||e.webkitForce||0;i!==r&&(t.trigger("pressure",i),s.trigger("pressure "+t.identifier+":pressure",i),r=i)}).bind(s),100)};I.prototype.onstart=function(e){var t=this,n=t.options,s=e;e=Xe(e),t.updateBox();var r=function(i){t.actives.length<n.maxNumberOfNipples?t.processOnStart(i):s.type.match(/^touch/)&&(Object.keys(t.manager.ids).forEach(function(o){if(Object.values(s.touches).findIndex(function(u){return u.identifier===o})<0){var a=[e[0]];a.identifier=o,t.processOnEnd(a)}}),t.actives.length<n.maxNumberOfNipples&&t.processOnStart(i))};return ye(e,r),t.manager.bindDocument(),!1};I.prototype.processOnStart=function(e){var t=this,n=t.options,s,r=t.manager.getIdentifier(e),i=e.force||e.pressure||e.webkitForce||0,o={x:e.pageX,y:e.pageY},a=t.getOrCreate(r,o);a.identifier!==r&&t.manager.removeIdentifier(a.identifier),a.identifier=r;var u=function(d){d.trigger("start",d),t.trigger("start "+d.id+":start",d),d.show(),i>0&&t.pressureFn(e,d,d.identifier),t.processOnMove(e)};if((s=t.idles.indexOf(a))>=0&&t.idles.splice(s,1),t.actives.push(a),t.ids.push(a.identifier),n.mode!=="semi")u(a);else{var c=ee(o,a.position);if(c<=n.catchDistance)u(a);else{a.destroy(),t.processOnStart(e);return}}return a};I.prototype.getOrCreate=function(e,t){var n=this,s=n.options,r;return/(semi|static)/.test(s.mode)?(r=n.idles[0],r?(n.idles.splice(0,1),r):s.mode==="semi"?n.createNipple(t,e):(console.warn("Coudln't find the needed nipple."),!1)):(r=n.createNipple(t,e),r)};I.prototype.processOnMove=function(e){var t=this,n=t.options,s=t.manager.getIdentifier(e),r=t.nipples.get(s),i=t.manager.scroll;if(!En(e)){this.processOnEnd(e);return}if(!r){console.error("Found zombie joystick with ID "+s),t.manager.removeIdentifier(s);return}if(n.dynamicPage){var o=r.el.getBoundingClientRect();r.position={x:i.x+o.left,y:i.y+o.top}}r.identifier=s;var a=r.options.size/2,u={x:e.pageX,y:e.pageY};n.lockX&&(u.y=r.position.y),n.lockY&&(u.x=r.position.x);var c=ee(u,r.position),d=Sn(u,r.position),h=pe(d),f=c/a,g={distance:c,position:u},m,p;if(r.options.shape==="circle"?(m=Math.min(c,a),p=Cn(r.position,m,d)):(p=kn(u,r.position,a),m=ee(p,r.position)),n.follow){if(c>a){let V=u.x-p.x,S=u.y-p.y;r.position.x+=V,r.position.y+=S,r.el.style.top=r.position.y-(t.box.top+i.y)+"px",r.el.style.left=r.position.x-(t.box.left+i.x)+"px",c=ee(u,r.position)}}else u=p,c=m;var b=u.x-r.position.x,x=u.y-r.position.y;r.frontPosition={x:b,y:x},n.dataOnly||(r.ui.front.style.transform="translate("+b+"px,"+x+"px)");var C={identifier:r.identifier,position:u,force:f,pressure:e.force||e.pressure||e.webkitForce||0,distance:c,angle:{radian:h,degree:d},vector:{x:b/a,y:-x/a},raw:g,instance:r,lockX:n.lockX,lockY:n.lockY};C=r.computeDirection(C),C.angle={radian:pe(180-d),degree:180-d},r.trigger("move",C),t.trigger("move "+r.id+":move",C)};I.prototype.processOnEnd=function(e){var t=this,n=t.options,s=t.manager.getIdentifier(e),r=t.nipples.get(s),i=t.manager.removeIdentifier(r.identifier);r&&(n.dataOnly||r.hide(function(){n.mode==="dynamic"&&(r.trigger("removed",r),t.trigger("removed "+r.id+":removed",r),t.manager.trigger("removed "+r.id+":removed",r),r.destroy())}),clearInterval(t.pressureIntervals[r.identifier]),r.resetDirection(),r.trigger("end",r),t.trigger("end "+r.id+":end",r),t.ids.indexOf(r.identifier)>=0&&t.ids.splice(t.ids.indexOf(r.identifier),1),t.actives.indexOf(r)>=0&&t.actives.splice(t.actives.indexOf(r),1),/(semi|static)/.test(n.mode)?t.idles.push(r):t.nipples.indexOf(r)>=0&&t.nipples.splice(t.nipples.indexOf(r),1),t.manager.unbindDocument(),/(semi|static)/.test(n.mode)&&(t.manager.ids[i.id]=i.identifier))};I.prototype.onDestroyed=function(e,t){var n=this;n.nipples.indexOf(t)>=0&&n.nipples.splice(n.nipples.indexOf(t),1),n.actives.indexOf(t)>=0&&n.actives.splice(n.actives.indexOf(t),1),n.idles.indexOf(t)>=0&&n.idles.splice(n.idles.indexOf(t),1),n.ids.indexOf(t.identifier)>=0&&n.ids.splice(n.ids.indexOf(t.identifier),1),n.manager.removeIdentifier(t.identifier),n.manager.unbindDocument()};I.prototype.destroy=function(){var e=this;e.unbindEvt(e.options.zone,"start"),e.nipples.forEach(function(n){n.destroy()});for(var t in e.pressureIntervals)e.pressureIntervals.hasOwnProperty(t)&&clearInterval(e.pressureIntervals[t]);e.trigger("destroyed",e.nipples),e.manager.unbindDocument(),e.off()};function T(e){var t=this;t.ids={},t.index=0,t.collections=[],t.scroll=Fe(),t.config(e),t.prepareCollections();var n=function(){var r;t.collections.forEach(function(i){i.forEach(function(o){r=o.el.getBoundingClientRect(),o.position={x:t.scroll.x+r.left,y:t.scroll.y+r.top}})})};ie(window,"resize",function(){Me(n)});var s=function(){t.scroll=Fe()};return ie(window,"scroll",function(){Me(s)}),t.collections}T.prototype=new j;T.constructor=T;T.prototype.prepareCollections=function(){var e=this;e.collections.create=e.create.bind(e),e.collections.on=e.on.bind(e),e.collections.off=e.off.bind(e),e.collections.destroy=e.destroy.bind(e),e.collections.get=function(t){var n;return e.collections.every(function(s){return n=s.get(t),!n}),n}};T.prototype.create=function(e){return this.createCollection(e)};T.prototype.createCollection=function(e){var t=this,n=new I(t,e);return t.bindCollection(n),t.collections.push(n),n};T.prototype.bindCollection=function(e){var t=this,n,s=function(r,i){n=r.type+" "+i.id+":"+r.type,t.trigger(n,i)};e.on("destroyed",t.onDestroyed.bind(t)),e.on("shown hidden rested dir plain",s),e.on("dir:up dir:right dir:down dir:left",s),e.on("plain:up plain:right plain:down plain:left",s)};T.prototype.bindDocument=function(){var e=this;e.binded||(e.bindEvt(document,"move").bindEvt(document,"end"),e.binded=!0)};T.prototype.unbindDocument=function(e){var t=this;(!Object.keys(t.ids).length||e===!0)&&(t.unbindEvt(document,"move").unbindEvt(document,"end"),t.binded=!1)};T.prototype.getIdentifier=function(e){var t;return e?(t=e.identifier===void 0?e.pointerId:e.identifier,t===void 0&&(t=this.latest||0)):t=this.index,this.ids[t]===void 0&&(this.ids[t]=this.index,this.index+=1),this.latest=t,this.ids[t]};T.prototype.removeIdentifier=function(e){var t={};for(var n in this.ids)if(this.ids[n]===e){t.id=n,t.identifier=this.ids[n],delete this.ids[n];break}return t};T.prototype.onmove=function(e){var t=this;return t.onAny("move",e),!1};T.prototype.onend=function(e){var t=this;return t.onAny("end",e),!1};T.prototype.oncancel=function(e){var t=this;return t.onAny("end",e),!1};T.prototype.onAny=function(e,t){var n=this,s,r="processOn"+e.charAt(0).toUpperCase()+e.slice(1);t=Xe(t);var i=function(a,u,c){c.ids.indexOf(u)>=0&&(c[r](a),a._found_=!0)},o=function(a){s=n.getIdentifier(a),ye(n.collections,i.bind(null,a,s)),a._found_||n.removeIdentifier(s)};return ye(t,o),!1};T.prototype.destroy=function(){var e=this;e.unbindDocument(!0),e.ids={},e.index=0,e.collections.forEach(function(t){t.destroy()}),e.off()};T.prototype.onDestroyed=function(e,t){var n=this;if(n.collections.indexOf(t)<0)return!1;n.collections.splice(n.collections.indexOf(t),1)};const ze=new T,Nn={create:function(e){return ze.create(e)},factory:ze},Pn=y({shadowDomName:"shade-nipple",constructed:async({element:e,props:t})=>{const n=Nn.create({zone:e,...t.managerOptions});return t.onStart&&n.on("start",t.onStart),t.onEnd&&n.on("end",t.onEnd),t.onDir&&n.on("dir",t.onDir),t.onMove&&n.on("move",t.onMove),()=>n.destroy()},render:({children:e})=>e?l(l,null,e):l("div",null)});var Rn=Object.defineProperty,Mn=Object.getOwnPropertyDescriptor,Ln=(e,t,n,s)=>{for(var r=s>1?void 0:s?Mn(t,n):t,i=e.length-1,o;i>=0;i--)(o=e[i])&&(r=(s?o(t,n,r):o(r))||r);return s&&r&&Rn(t,n,r),r};let Y=class{constructor(e,t,n){O(this,"logger");O(this,"leftSpeed",new v(0));O(this,"rightSpeed",new v(0));O(this,"frontDistance",new v(0));O(this,"isMotorTicksChange",e=>(e==null?void 0:e.type)==="motorTicksChange"&&!isNaN(e.index)&&!isNaN(e.ticks));O(this,"isDistanceChange",e=>(e==null?void 0:e.type)==="distance"&&!isNaN(e.distanceCm));this.webSocket=e,this.settings=t,this.logger=n.logger.withScope("MovementService"),this.webSocket.lastMessage.subscribe(s=>{const r=s.dataObject;this.isMotorTicksChange(r)&&(r.index===0?this.leftSpeed.setValue(parseInt(r.ticks,10)):r.index===1&&this.rightSpeed.setValue(parseInt(r.ticks,10))),this.isDistanceChange(r)&&this.frontDistance.setValue(r.distanceCm)})}stop(){this.logger.verbose({message:"Stopped"}),this.webSocket.send("move 0 0")}async move(e,t){this.settings.currentSettings.getValue().isPidEnabled?this.webSocket.send(`moveTicks ${Math.round(e)} ${Math.round(t)}`):this.webSocket.send(`move ${Math.round(e*this.settings.currentSettings.getValue().throttleSensitivity)} ${Math.round(t*this.settings.currentSettings.getValue().throttleSensitivity)}`)}};Y=Ln([_({lifetime:"singleton"})],Y);const Fn=y({getInitialState:({injector:e})=>({movementService:e.getInstance(Y),updateInterval:setInterval(()=>{},100)}),constructed:({updateState:e,getState:t})=>(clearInterval(t().updateInterval),e({updateInterval:setInterval(()=>{const{sendData:n}=t();n&&(t().movementService.move(n.leftSpeed,n.rightSpeed),e({sendData:void 0},!0))},100)}),()=>clearInterval(t().updateInterval)),render:({updateState:e})=>l("div",{style:{width:"100%",height:"100%",position:"relative"}},l(Pn,{style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%"},managerOptions:{},onEnd:()=>e({sendData:{leftSpeed:0,rightSpeed:0}},!0),onMove:(t,n)=>{var c;const s=((c=n.direction)==null?void 0:c.y)==="down"?-1:1,r=Math.cos(n.angle.radian-Math.PI),i=Math.round(n.force),o=Math.round(i/1.3),a=(i+r*o)*s,u=(i-r*o)*s;e({sendData:{leftSpeed:a,rightSpeed:u}},!0)}}))});var jn=Object.defineProperty,zn=Object.getOwnPropertyDescriptor,An=(e,t,n,s)=>{for(var r=s>1?void 0:s?zn(t,n):t,i=e.length-1,o;i>=0;i--)(o=e[i])&&(r=(s?o(t,n,r):o(r))||r);return s&&r&&jn(t,n,r),r};let K=class{constructor(e,t){O(this,"isConnected",new v(!1));O(this,"eventStream",[]);O(this,"lastMessage",new v);O(this,"socket");O(this,"logger");O(this,"onConnect",(()=>{this.logger.verbose({message:"Connected",data:{socket:this.socket}}),this.isConnected.setValue(!0)}).bind(this));O(this,"onDisconnect",(()=>{this.logger.verbose({message:"Disconnected",data:{socket:this.socket}}),this.isConnected.setValue(!1),this.disposeSocket(this.socket),this.socket=this.createSocket(),this.lastMessage.setValue({type:"connection",data:"Socket disconnected"})}).bind(this));O(this,"onOpen",(()=>{this.logger.verbose({message:"Opened",data:{socket:this.socket}}),this.lastMessage.setValue({type:"connection",data:"Socket opened"})}).bind(this));O(this,"onClose",(()=>{this.logger.verbose({message:"Closed",data:{socket:this.socket}}),this.lastMessage.setValue({type:"connection",data:"Socket closed"})}).bind(this));O(this,"onError",(()=>{this.logger.warning({message:"Socket Error",data:{socket:this.socket}}),this.lastMessage.setValue({type:"connection",data:"Socket Error"})}).bind(this));O(this,"onMessage",(e=>{try{this.lastMessage.setValue({type:"incoming",data:e.data.toString(),dataObject:JSON.parse(e.data.toString())})}catch{this.lastMessage.setValue({type:"incoming",data:e.data.toString()})}this.logger.verbose({message:"Message received",data:{socket:this.socket,data:e.data}})}).bind(this));this.env=e,this.logger=t.logger.withScope("WebSocketService"),this.socket=this.createSocket(),this.lastMessage.subscribe(n=>this.eventStream.push({...n,date:new Date}))}send(e){this.socket.readyState===WebSocket.OPEN&&(this.socket.send(e),this.lastMessage.setValue({type:"outgoing",data:e}))}createSocket(){const e=new WebSocket(`ws://${dt.joinPaths(this.env.site,"ws")}`);return e.addEventListener("connect",this.onConnect),e.addEventListener("disconnect",this.onDisconnect),e.addEventListener("open",this.onOpen),e.addEventListener("close",this.onClose),e.addEventListener("error",this.onError),e.addEventListener("message",this.onMessage),e}disposeSocket(e){e.removeEventListener("connect",this.onConnect),e.removeEventListener("disconnect",this.onDisconnect),e.removeEventListener("open",this.onOpen),e.removeEventListener("close",this.onClose),e.removeEventListener("error",this.onError),e.removeEventListener("message",this.onMessage)}dispose(){this.socket&&this.disposeSocket(this.socket),this.lastMessage.dispose()}};K=An([_({lifetime:"singleton"})],K);const $n=y({shadowDomName:"flea-console-entries",getInitialState:({injector:e})=>({webSocketService:e.getInstance(K),entries:e.getInstance(K).eventStream}),constructed:({getState:e,updateState:t,element:n})=>{var r,i;const s=e().webSocketService.lastMessage.subscribe(()=>{var o,a;t({entries:e().webSocketService.eventStream}),(a=n.parentElement)==null||a.scrollTo({top:((o=n.firstElementChild)==null?void 0:o.scrollHeight)||Number.MAX_SAFE_INTEGER})});return(i=n.parentElement)==null||i.scrollTo({top:((r=n.firstElementChild)==null?void 0:r.scrollHeight)||Number.MAX_SAFE_INTEGER}),()=>{s.dispose()}},render:({getState:e})=>l("div",null,e().entries.map(t=>l("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",fontFamily:"monospace"}},l("div",{style:{fontSize:"20px",width:"40px",height:"40px",textAlign:"center",verticalAlign:"middle",lineHeight:"40px",flexShrink:"0",marginRight:"1em",color:t.type==="incoming"?"#aa2233":"#22bb33"}},t.type==="incoming"?"<":t.type==="outgoing"?">":"|"," ")," ",t.dataObject?l("code",{style:{whiteSpace:"pre-wrap"}},JSON.stringify(t.dataObject,void 0,2)):l("div",null," ",t.data," "))))}),qn=y({getInitialState:({injector:e})=>({webSocketService:e.getInstance(K),command:""}),shadowDomName:"flea-console-page",render:({getState:e,updateState:t})=>l("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",overflow:"hidden",color:"#bbb",backgroundColor:"rgba(66, 66, 66, .5)",backdropFilter:"blur(10px)"}},l("div",{style:{flexGrow:"1",overflow:"auto",height:"100px",padding:"1em"}},l($n,null)),l("form",{style:{display:"flex",flexDirection:"row",width:"100%",flexShrink:"0"},onsubmit:n=>{n.preventDefault(),e().webSocketService.send(e().command),t({command:""},!0),n.target.reset()}},l("input",{autofocus:!0,style:{display:"block",flexGrow:"1",width:"100%"},placeholder:"Command",onkeyup:n=>{var s;return t({command:(s=n.target)==null?void 0:s.value},!0)}}),l(F,{title:"Send",type:"submit"},"Send")))}),Hn=y({render:({injector:e})=>l("div",{style:{display:"flex",height:"80%",width:"100%",justifyContent:"center",alignItems:"center",backgroundColor:"rgba(66, 66, 66, .5)",backdropFilter:"blur(15px)"}},l("form",{style:{display:"flex",flexDirection:"column"},action:`http://${e.getInstance(ne).site}/update`,accept:"application/octet-stream",enctype:"multipart/form-data",method:"POST"},l("div",null,l("input",{type:"file",name:"update",style:{margin:"2em"},accept:"application/octet-stream"}),l("input",{type:"submit",value:"Update"}))))});var Bn=Object.defineProperty,Wn=Object.getOwnPropertyDescriptor,Un=(e,t,n,s)=>{for(var r=s>1?void 0:s?Wn(t,n):t,i=e.length-1,o;i>=0;i--)(o=e[i])&&(r=(s?o(t,n,r):o(r))||r);return s&&r&&Bn(t,n,r),r};const de="FLEA_SETTINGS",Ke={isPidEnabled:!1,throttleSensitivity:256};let G=class{constructor(e){O(this,"currentSettings",new v(Ke));O(this,"logger");this.logger=e.logger.withScope("ClientSettings"),this.initConfig(),this.currentSettings.subscribe(t=>{localStorage.setItem(de,JSON.stringify(t)),e.getInstance(Q).addNoty({type:"success",title:"Success",body:"Configuration saved"})})}initConfig(){const e=localStorage.getItem(de);try{const t=JSON.parse(e||"");this.currentSettings.setValue({...this.currentSettings.getValue(),...t})}catch{this.logger.warning({message:"Failed to parse stored settings. Resetting to defaults..."}),localStorage.removeItem(de)}}};G=Un([_({lifetime:"singleton"})],G);const Jn=y({getInitialState:({injector:e})=>e.getInstance(G).currentSettings.getValue(),constructed:({injector:e,updateState:t})=>{const n=e.getInstance(G).currentSettings.subscribe(s=>t(s));return()=>n.dispose()},render:({getState:e,injector:t})=>{const{throttleSensitivity:n,isPidEnabled:s}=e(),r=t.getInstance(E),i=t.getInstance(G);return l("div",{style:{marginTop:"4em",color:r.theme.getValue().text.secondary,padding:"2em",backgroundColor:"rgba(66, 66, 66, .5)",backdropFilter:"blur(15px)"}},l("h1",null,"Settings"),l(Se,{labelTitle:"Throttle sensitivity",type:"number",value:n.toString(),min:"1",max:"1024",onTextChange:o=>{i.currentSettings.setValue({...i.currentSettings.getValue(),throttleSensitivity:parseInt(o,10)})}}),l("div",null,"Control mode",l(F,{variant:s?"contained":"outlined",onclick:()=>{i.currentSettings.setValue({...i.currentSettings.getValue(),isPidEnabled:!0})}},"PID"),l(F,{variant:s?"outlined":"contained",onclick:()=>{i.currentSettings.setValue({...i.currentSettings.getValue(),isPidEnabled:!1})}},"Direct")),l(F,{color:"warning",onclick:()=>{i.currentSettings.setValue(Ke)}},"Reset to defaults"))}}),Gn=y({shadowDomName:"status-component",getInitialState:({injector:e})=>{const t=e.getInstance(Y);return{leftSpeed:t.leftSpeed.getValue(),rightSpeed:t.rightSpeed.getValue(),distance:t.frontDistance.getValue()}},constructed:({injector:e,updateState:t})=>{const n=e.getInstance(Y),s=[n.leftSpeed.subscribe(r=>{t({leftSpeed:r})}),n.rightSpeed.subscribe(r=>{t({rightSpeed:r})}),n.frontDistance.subscribe(r=>{t({distance:r})})];return()=>s.forEach(r=>r.dispose())},render:({getState:e,injector:t})=>{const{leftSpeed:n,rightSpeed:s,distance:r}=e(),i=t.getInstance(E),o=t.getInstance(fe);console.log(o.orientation.getValue());const a=c=>{const d=c===0?"#222222":c===1?"#00FF00":c===2?"#FFFF00":"#FF0000",h=i.getTextColor(d);return{backgroundColor:d,color:h}},u=c=>{const d=c<.001?"#000000":c<6?"#FF0000":c<16?"#FF9900":c<30?"#FFFF00":c<40?"#00FF00":"#0000FF",h=i.getTextColor(d);return{backgroundColor:d,color:h}};return l("div",{style:{display:"flex",height:"100%",width:"100%",color:"white"}},l("div",{style:{borderRadius:"25%",width:"15%",height:"55%",textAlign:"center",...a(n)}},n.toString()),l("div",{style:{width:"70%",height:"100%",backgroundColor:"rgba(0,0,0,0.4)",display:"flex",flexDirection:"row",alignContent:"flex-start",justifyContent:"center",alignItems:"flex-start"}},l("div",{style:{padding:"15px",margin:"1em",borderRadius:"5px",...u(r)}},r.toString()," cm")),l("div",{style:{borderRadius:"25%",width:"15%",height:"55%",textAlign:"center",...a(s)}},s.toString()))}}),Qn=y({shadowDomName:"flea-layout",render:({injector:e})=>l("div",{style:{width:"100%",height:"100%",overflow:"hidden",display:"flex",flexDirection:"column",lineHeight:"18px"}},l(Wt,null,l("div",{style:{width:"calc(100% - 16px)",display:"flex"}},l(J,{href:"/",style:{marginRight:"0.5em"}},"Flea"),"Â ",l(J,{href:"/settings"},"Settings"),"Â |Â ",l(J,{href:"/console"},"Console"),"Â |Â ",l(J,{href:"/update"},"Update"),l("div",{style:{flex:"1"}}))),l("div",{style:{position:"fixed",width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",zIndex:"-1",backgroundColor:e.getInstance(E).theme.getValue().background.default}},l(Gn,{style:{width:"calc(100% - 15em)",height:"calc(100% - 15em)"}})),l("div",{style:{width:"100%",height:"100%",flexGrow:"1"}},l(Lt,{routes:[{url:"/",component:()=>l(Fn,null)},{url:"/settings",component:()=>l(Jn,null)},{url:"/console",component:()=>l(qn,null)},{url:"/update",component:()=>l(Hn,null)}]})),l(un,null))}),Ee=new L;Ee.useLogging(he);Ee.setExplicitInstance({nodeEnv:"production",buildDate:new Date({}.BUILD_DATE),site:{}.SITE||window.location.host},ne);const Xn=document.getElementById("root");Ft({rootElement:Xn,injector:Ee,jsxElement:l(Qn,null)});
